[{"path":"https://bcgov.github.io/pahwq/CODE_OF_CONDUCT.html","id":null,"dir":"","previous_headings":"","what":"Contributor Code of Conduct","title":"Contributor Code of Conduct","text":"contributors maintainers project, interest fostering open welcoming community, pledge respect people contribute reporting issues, posting feature requests, updating documentation, submitting pull requests patches, activities. committed making participation project harassment-free experience everyone, regardless level experience, gender, gender identity expression, sexual orientation, disability, personal appearance, body size, race, ethnicity, age, religion, nationality. Examples unacceptable behavior participants include: use sexualized language imagery Personal attacks Trolling insulting/derogatory comments Public private harassment Publishing ’s private information, physical electronic addresses, without explicit permission unethical unprofessional conduct Project maintainers right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, ban temporarily permanently contributor behaviors deem inappropriate, threatening, offensive, harmful. adopting Code Conduct, project maintainers commit fairly consistently applying principles every aspect managing project. Project maintainers follow enforce Code Conduct may permanently removed project team. Code Conduct applies within project spaces public spaces individual representing project community. Instances abusive, harassing, otherwise unacceptable behavior may reported contacting project maintainer angeline.tillmanns@gov.bc.ca. complaints reviewed investigated result response deemed necessary appropriate circumstances. Maintainers obligated maintain confidentiality regard reporter incident. Code Conduct adapted Contributor Covenant, version 1.3.0, available http://contributor-covenant.org/version/1/3/0/ project created using bcgovr package.","code":""},{"path":"https://bcgov.github.io/pahwq/CONTRIBUTING.html","id":"how-to-contribute","dir":"","previous_headings":"","what":"How to contribute","title":"NA","text":"Government employees, public members private sector encouraged contribute repository forking submitting pull request. (new GitHub, might start basic tutorial check detailed guide pull requests.) Pull requests evaluated repository guardians schedule deemed beneficial committed master. contributors retain original copyright stuff, contributing project, grant world-wide, royalty-free, perpetual, irrevocable, non-exclusive, transferable license users terms license project distributed. project created using bcgovr package.","code":""},{"path":"https://bcgov.github.io/pahwq/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"Apache License","title":"Apache License","text":"Version 2.0, January 2004 <http://www.apache.org/licenses/>","code":""},{"path":[]},{"path":"https://bcgov.github.io/pahwq/LICENSE.html","id":"id_1-definitions","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"1. Definitions","title":"Apache License","text":"“License” shall mean terms conditions use, reproduction, distribution defined Sections 1 9 document. “Licensor” shall mean copyright owner entity authorized copyright owner granting License. “Legal Entity” shall mean union acting entity entities control, controlled , common control entity. purposes definition, “control” means () power, direct indirect, cause direction management entity, whether contract otherwise, (ii) ownership fifty percent (50%) outstanding shares, (iii) beneficial ownership entity. “” (“”) shall mean individual Legal Entity exercising permissions granted License. “Source” form shall mean preferred form making modifications, including limited software source code, documentation source, configuration files. “Object” form shall mean form resulting mechanical transformation translation Source form, including limited compiled object code, generated documentation, conversions media types. “Work” shall mean work authorship, whether Source Object form, made available License, indicated copyright notice included attached work (example provided Appendix ). “Derivative Works” shall mean work, whether Source Object form, based (derived ) Work editorial revisions, annotations, elaborations, modifications represent, whole, original work authorship. purposes License, Derivative Works shall include works remain separable , merely link (bind name) interfaces , Work Derivative Works thereof. “Contribution” shall mean work authorship, including original version Work modifications additions Work Derivative Works thereof, intentionally submitted Licensor inclusion Work copyright owner individual Legal Entity authorized submit behalf copyright owner. purposes definition, “submitted” means form electronic, verbal, written communication sent Licensor representatives, including limited communication electronic mailing lists, source code control systems, issue tracking systems managed , behalf , Licensor purpose discussing improving Work, excluding communication conspicuously marked otherwise designated writing copyright owner “Contribution.” “Contributor” shall mean Licensor individual Legal Entity behalf Contribution received Licensor subsequently incorporated within Work.","code":""},{"path":"https://bcgov.github.io/pahwq/LICENSE.html","id":"id_2-grant-of-copyright-license","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"2. Grant of Copyright License","title":"Apache License","text":"Subject terms conditions License, Contributor hereby grants perpetual, worldwide, non-exclusive, -charge, royalty-free, irrevocable copyright license reproduce, prepare Derivative Works , publicly display, publicly perform, sublicense, distribute Work Derivative Works Source Object form.","code":""},{"path":"https://bcgov.github.io/pahwq/LICENSE.html","id":"id_3-grant-of-patent-license","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"3. Grant of Patent License","title":"Apache License","text":"Subject terms conditions License, Contributor hereby grants perpetual, worldwide, non-exclusive, -charge, royalty-free, irrevocable (except stated section) patent license make, made, use, offer sell, sell, import, otherwise transfer Work, license applies patent claims licensable Contributor necessarily infringed Contribution(s) alone combination Contribution(s) Work Contribution(s) submitted. institute patent litigation entity (including cross-claim counterclaim lawsuit) alleging Work Contribution incorporated within Work constitutes direct contributory patent infringement, patent licenses granted License Work shall terminate date litigation filed.","code":""},{"path":"https://bcgov.github.io/pahwq/LICENSE.html","id":"id_4-redistribution","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"4. Redistribution","title":"Apache License","text":"may reproduce distribute copies Work Derivative Works thereof medium, without modifications, Source Object form, provided meet following conditions: () must give recipients Work Derivative Works copy License; (b) must cause modified files carry prominent notices stating changed files; (c) must retain, Source form Derivative Works distribute, copyright, patent, trademark, attribution notices Source form Work, excluding notices pertain part Derivative Works; (d) Work includes “NOTICE” text file part distribution, Derivative Works distribute must include readable copy attribution notices contained within NOTICE file, excluding notices pertain part Derivative Works, least one following places: within NOTICE text file distributed part Derivative Works; within Source form documentation, provided along Derivative Works; , within display generated Derivative Works, wherever third-party notices normally appear. contents NOTICE file informational purposes modify License. may add attribution notices within Derivative Works distribute, alongside addendum NOTICE text Work, provided additional attribution notices construed modifying License. may add copyright statement modifications may provide additional different license terms conditions use, reproduction, distribution modifications, Derivative Works whole, provided use, reproduction, distribution Work otherwise complies conditions stated License.","code":""},{"path":"https://bcgov.github.io/pahwq/LICENSE.html","id":"id_5-submission-of-contributions","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"5. Submission of Contributions","title":"Apache License","text":"Unless explicitly state otherwise, Contribution intentionally submitted inclusion Work Licensor shall terms conditions License, without additional terms conditions. Notwithstanding , nothing herein shall supersede modify terms separate license agreement may executed Licensor regarding Contributions.","code":""},{"path":"https://bcgov.github.io/pahwq/LICENSE.html","id":"id_6-trademarks","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"6. Trademarks","title":"Apache License","text":"License grant permission use trade names, trademarks, service marks, product names Licensor, except required reasonable customary use describing origin Work reproducing content NOTICE file.","code":""},{"path":"https://bcgov.github.io/pahwq/LICENSE.html","id":"id_7-disclaimer-of-warranty","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"7. Disclaimer of Warranty","title":"Apache License","text":"Unless required applicable law agreed writing, Licensor provides Work (Contributor provides Contributions) “” BASIS, WITHOUT WARRANTIES CONDITIONS KIND, either express implied, including, without limitation, warranties conditions TITLE, NON-INFRINGEMENT, MERCHANTABILITY, FITNESS PARTICULAR PURPOSE. solely responsible determining appropriateness using redistributing Work assume risks associated exercise permissions License.","code":""},{"path":"https://bcgov.github.io/pahwq/LICENSE.html","id":"id_8-limitation-of-liability","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"8. Limitation of Liability","title":"Apache License","text":"event legal theory, whether tort (including negligence), contract, otherwise, unless required applicable law (deliberate grossly negligent acts) agreed writing, shall Contributor liable damages, including direct, indirect, special, incidental, consequential damages character arising result License use inability use Work (including limited damages loss goodwill, work stoppage, computer failure malfunction, commercial damages losses), even Contributor advised possibility damages.","code":""},{"path":"https://bcgov.github.io/pahwq/LICENSE.html","id":"id_9-accepting-warranty-or-additional-liability","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"9. Accepting Warranty or Additional Liability","title":"Apache License","text":"redistributing Work Derivative Works thereof, may choose offer, charge fee , acceptance support, warranty, indemnity, liability obligations /rights consistent License. However, accepting obligations, may act behalf sole responsibility, behalf Contributor, agree indemnify, defend, hold Contributor harmless liability incurred , claims asserted , Contributor reason accepting warranty additional liability. END TERMS CONDITIONS","code":""},{"path":"https://bcgov.github.io/pahwq/LICENSE.html","id":"appendix-how-to-apply-the-apache-license-to-your-work","dir":"","previous_headings":"","what":"APPENDIX: How to apply the Apache License to your work","title":"Apache License","text":"apply Apache License work, attach following boilerplate notice, fields enclosed brackets [] replaced identifying information. (Don’t include brackets!) text enclosed appropriate comment syntax file format. also recommend file class name description purpose included “printed page” copyright notice easier identification within third-party archives.","code":"Copyright [yyyy] [name of copyright owner]  Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License. You may obtain a copy of the License at    http://www.apache.org/licenses/LICENSE-2.0  Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License."},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"input-parameters","dir":"Articles","previous_headings":"","what":"Input parameters","title":"Sensitivity Analysis","text":"input parameters calculation light attenuation water TUV model : Kd Light attenuation coefficient (set directly calculated DOC) Sk (default 0.018) ref_wvl Reference wavelength Kd (default 305) depth_m Water depth m lat Latitude decimal degrees lon Longitude decimal degrees elev_km Surface elevation, km sea level year Year month Month day Day tzone Timezone Local Time - UTC (default 0; UTC) tstart Start time, hours local time (default 0) tstop Stop time, hours local time (default 23) tsteps Number time steps (default 24) albedo Surface albedo (default 0.07) o3_tc Ozone column, Dobson Units (DU) - Looked climatology (recommended default 300) so2_tc SO2 column, DU (default 0) no2_tc NO2 column, DU (default 0) taucld Cloud optical depth (default 0) zbase Cloud base, km (default 4) ztop Cloud top, km (default 5) tauaer Aerosol optical depth 550 nm - Looked climatology (recommended default 0.235) ssaaer Aerosol single scattering albedo (default 0.990) alpha Aerosol Angstrom exponent(default 1.0) wvl_start Starting wavelength, nm (default 279.5) wvl_end End wavelength, nm (default 400.5) wvl_steps Number wavelength intervals (default 121) nstr TUV run type; use -2 fast, 4 slightly accurate (default -2) currently consideration sensitivity analysis : Kd Light attenuation coefficient - includes use DOC calculating Kd lat Latitude decimal degrees lon Longitude decimal degrees elev_km Surface elevation, km sea level albedo Surface albedo (default 0.07) o3_tc Ozone column, Dobson Units (DU) - Looked climatology (recommended default 300) tauaer Aerosol optical depth 550 nm - Looked climatology (recommended default 0.235) ssaaer Aerosol single scattering albedo (default 0.990) nstr TUV run type; use -2 fast, 4 slightly accurate (default -2) analyses conducted three different sample lakes (Southern Interior, Vancouver Island, Northeast), using two PAHs (Anthracene Benzo[]pyrene). Initially, sensitivity analyses univariate (varying input interest holding others constant). significant interactions expected certain variables, can explored.","code":""},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"basic-usage-of-the-pahwq-package","dir":"Articles","previous_headings":"","what":"Basic usage of the pahwq package","title":"Sensitivity Analysis","text":"calculate acute phototoxic water quality guideline (PLC50) Anthracene 0.25 m depth Okanagan Lake June 21, 2023, measured DOC 5 g/m^3, use following code: First, set options model run: can view options used TUV. set via function inputs, looked : Run TUV model get results. results show underwater irradiance specified depth, wavelength time step. can inspect inputs used model run: Next, calculate site-specific light absorption (\\(P_{abs}\\)) Anthracene TUV results. p_abs() function uses lookup table get molar absorption coefficient specified PAH. Finally, calculate PLC50 𝝁g/L, supplying \\(P_{abs}\\) value. can compare PLC50 NLC50 see effect photoxicity PAH:","code":"library(pahwq)  set_tuv_aq_params(   depth_m = 0.25,   lat = 49.601632,   lon = -119.605862,   elev_km = 0.342,   DOC = 5,   date = \"2023-06-21\",   tzone = -8,   albedo = 0.05 ) view_tuv_aq_params() #> a,b,c for: kvdom = a exp(-b(wvl-c)). a = kd(305), b = Sk, c = wavelength, wvl = 305: 20.11 0.018 305 #> ydepth, m: 0.25 #> lat, negative S of Equator: 49.601632 #> lon, negative W of Greenwich (zero) meridian: -119.605862 #> surface elevation, km above sea level: 0.342 #> timezone: Local Time - UTC: -8 #> iyear: 2023 #> imonth: 6 #> iday: 21 #> tstart, hours local time: 0 #> tstop, hours local time: 23 #> number of time steps: 24 #> surface albedo: 0.05 #> o3_tc  ozone column, Dobson Units (DU): 359.937 #> so2_tc SO2 column, DU: 0 #> no2_tc NO2 column, DU: 0 #> taucld - cloud optical depth: 0 #> zbase - cloud base, km: 4 #> ztop - cloud top, km: 5 #> tauaer - aerosol optical depth at 550 nm: 0.0641989811085006 #> ssaaer - aerosol single scattering albedo: 0.99 #> alpha - aerosol Angstrom exponent: 1 #> starting wavelength, nm: 279.5 #> end wavelength, nm: 420.5 #> number of wavelength intervals: 141 #> nstr, use -2 for fast, 4 for slightly more accurate: -2 #> out_irrad_y, T/F, planar spectral irradiance at ydepth: T #> out_aflux_y, T/F, scalar spectral irradiance (actinic flux)  at depth: T #> out_irrad_ave, T/F, planar irrad., averaged 0-ydepth: T #> out_aflux_ave, T/F, scalar, ave 0-ydepth: T #> out_irrad_atm, T/F, planar, in atmosphere: T #> out_aflux_atm, T/F, scalar, in atmosphere: T run_tuv()  # Get the results res <- get_tuv_results(file = \"out_irrad_y\") head(res) #>    wl wavelength_start wavelength_end Kd_lambda t_00.00.00 t_01.00.00 #> 1 280            279.5          280.5      31.5          0          0 #> 2 281            280.5          281.5      31.0          0          0 #> 3 282            281.5          282.5      30.4          0          0 #> 4 283            282.5          283.5      29.9          0          0 #> 5 284            283.5          284.5      29.3          0          0 #> 6 285            284.5          285.5      28.8          0          0 #>   t_02.00.00 t_03.00.00 t_04.00.00 t_05.00.00 t_06.00.00 t_07.00.00 t_08.00.00 #> 1          0          0   3.16e-38   1.00e-37   1.90e-37   4.44e-37   7.97e-34 #> 2          0          0   3.21e-35   1.02e-34   1.94e-34   4.63e-34   6.16e-31 #> 3          0          0   3.74e-32   1.18e-31   2.27e-31   5.57e-31   5.39e-28 #> 4          0          0   1.84e-30   5.80e-30   1.12e-29   2.79e-29   2.25e-26 #> 5          0          0   2.19e-28   6.92e-28   1.35e-27   3.47e-27   2.16e-24 #> 6          0          0   1.75e-26   5.52e-26   1.09e-25   2.90e-25   1.36e-22 #>   t_09.00.00 t_10.00.00 t_11.00.00 t_12.00.00 t_13.00.00 t_14.00.00 t_15.00.00 #> 1   3.54e-29   2.17e-26   6.84e-25   2.05e-24   6.97e-25   2.26e-26   3.79e-29 #> 2   1.04e-26   3.65e-24   8.57e-23   2.34e-22   8.72e-23   3.79e-24   1.11e-26 #> 3   3.42e-24   6.74e-22   1.17e-20   2.90e-20   1.19e-20   6.97e-22   3.62e-24 #> 4   8.16e-23   1.16e-20   1.69e-19   3.97e-19   1.72e-19   1.20e-20   8.61e-23 #> 5   3.71e-21   3.41e-19   3.95e-18   8.62e-18   4.00e-18   3.51e-19   3.90e-21 #> 6   1.08e-19   6.33e-18   5.78e-17   1.17e-16   5.85e-17   6.49e-18   1.13e-19 #>   t_16.00.00 t_17.00.00 t_18.00.00 t_19.00.00 t_20.00.00 t_21.00.00 t_22.00.00 #> 1   8.93e-34   4.49e-37   1.91e-37   1.01e-37   3.22e-38          0          0 #> 2   6.83e-31   4.68e-34   1.95e-34   1.02e-34   3.27e-35          0          0 #> 3   5.92e-28   5.63e-31   2.28e-31   1.19e-31   3.81e-32          0          0 #> 4   2.46e-26   2.83e-29   1.13e-29   5.83e-30   1.87e-30          0          0 #> 5   2.34e-24   3.51e-27   1.36e-27   6.97e-28   2.23e-28          0          0 #> 6   1.46e-22   2.94e-25   1.09e-25   5.55e-26   1.78e-26          0          0 #>   t_23.00.00 #> 1          0 #> 2          0 #> 3          0 #> 4          0 #> 5          0 #> 6          0 tuv_run_params(res) #> a,b,c for: kvdom = a exp(-b(wvl-c)). a = kd(305), b = Sk, c = wavelength, wvl = 305  #>                                                                   \"20.11 0.018 305\"  #>                                                                           ydepth, m  #>                                                                              \"0.25\"  #>                                                          lat, negative S of Equator  #>                                                                         \"49.601632\"  #>                                        lon, negative W of Greenwich (zero) meridian  #>                                                                       \"-119.605862\"  #>                                               surface elevation, km above sea level  #>                                                                             \"0.342\"  #>                                                          timezone: Local Time - UTC  #>                                                                                \"-8\"  #>                                                                               iyear  #>                                                                              \"2023\"  #>                                                                              imonth  #>                                                                                 \"6\"  #>                                                                                iday  #>                                                                                \"21\"  #>                                                            tstart, hours local time  #>                                                                                 \"0\"  #>                                                             tstop, hours local time  #>                                                                                \"23\"  #>                                                                number of time steps  #>                                                                                \"24\"  #>                                                                      surface albedo  #>                                                                              \"0.05\"  #>                                              o3_tc  ozone column, Dobson Units (DU)  #>                                                                           \"359.937\"  #>                                                               so2_tc SO2 column, DU  #>                                                                                 \"0\"  #>                                                               no2_tc NO2 column, DU  #>                                                                                 \"0\"  #>                                                        taucld - cloud optical depth  #>                                                                                 \"0\"  #>                                                              zbase - cloud base, km  #>                                                                                 \"4\"  #>                                                                ztop - cloud top, km  #>                                                                                 \"5\"  #>                                            tauaer - aerosol optical depth at 550 nm  #>                                                                \"0.0641989811085006\"  #>                                           ssaaer - aerosol single scattering albedo  #>                                                                              \"0.99\"  #>                                                   alpha - aerosol Angstrom exponent  #>                                                                                 \"1\"  #>                                                             starting wavelength, nm  #>                                                                             \"279.5\"  #>                                                                  end wavelength, nm  #>                                                                             \"420.5\"  #>                                                      number of wavelength intervals  #>                                                                               \"141\"  #>                                 nstr, use -2 for fast, 4 for slightly more accurate  #>                                                                                \"-2\"  #>                              out_irrad_y, T/F, planar spectral irradiance at ydepth  #>                                                                                 \"T\"  #>               out_aflux_y, T/F, scalar spectral irradiance (actinic flux)  at depth  #>                                                                                 \"T\"  #>                                out_irrad_ave, T/F, planar irrad., averaged 0-ydepth  #>                                                                                 \"T\"  #>                                            out_aflux_ave, T/F, scalar, ave 0-ydepth  #>                                                                                 \"T\"  #>                                           out_irrad_atm, T/F, planar, in atmosphere  #>                                                                                 \"T\"  #>                                           out_aflux_atm, T/F, scalar, in atmosphere  #>                                                                                 \"T\" (Pabs <- p_abs(res, \"Anthracene\")) #> [1] 448.6275 plc50(Pabs, pah = \"Anthracene\") #> [1] 2.133157 nlc50(\"Anthracene\") #> [1] 58.40685"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Sensitivity Analysis","text":"’ll start loading packages need getting data B.C. EMS:","code":"library(sf) library(mapview) library(rems) library(dplyr) library(ggplot2) library(ggrepel) library(latex2exp)  con <- connect_historic_db() db <- attach_historic_data(con) sites_sf <- db |>    filter(     EMS_ID %in% c(\"0500236\", \"E207466\", \"0400390\"),     # grepl(\"(CHARLIE L)|(OKANAGAN)|(QUAMICHAN)\", MONITORING_LOCATION),      COLLECTION_START > as.Date(\"2020-01-01\"), PARAMETER_CODE == \"1103\"   ) |>    collect() |>    st_as_sf(coords = c(\"LONGITUDE\", \"LATITUDE\"), crs = 4326, remove = FALSE) |>    filter(!is.na(RESULT)) |>    arrange(desc(COLLECTION_START)) |>    group_by(EMS_ID, MONITORING_LOCATION, LONGITUDE, LATITUDE) |>    mutate(doc_min = min(RESULT), doc_max = max(RESULT)) |>    slice(1) |>    select(emsid = EMS_ID,           name = MONITORING_LOCATION,           lon = LONGITUDE,           lat = LATITUDE,           date = COLLECTION_START,           DOC = RESULT,          doc_min,          doc_max) |>    left_join(     tribble(       ~ emsid, ~elev_m,       \"E207466\", 25,       \"0400390\", 693,       \"0500236\", 342     ), by = join_by(\"emsid\")   ) |>    ungroup() |>    relocate(elev_m, .after = lat)  disconnect_historic_db(con)"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"locations","dir":"Articles","previous_headings":"","what":"Locations","title":"Sensitivity Analysis","text":"","code":"mapview(sites_sf, zcol = \"name\", legend = FALSE)"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"okanagan-lake-okanagan","dir":"Articles","previous_headings":"Locations","what":"Okanagan Lake, Okanagan","title":"Sensitivity Analysis","text":"EMS ID: 0500236 Region: Okanagan Latitude: 49.8614 N Longitude: 119.5134 W Site Depth: 70.1 m Maximum Lake Depth: 232 m Lake Elevation: 342 m Lake Surface Area: 350.08 sq km","code":""},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"charlie-lake-peace","dir":"Articles","previous_headings":"Locations","what":"Charlie Lake, Peace","title":"Sensitivity Analysis","text":"EMS ID: 0400390 Region: Peace Latitude: 56.3125 N Longitude: 120.9642 W Site Depth: 13 m Maximum Lake Depth: 13 m Lake Elevation: 693 m Lake Surface Area: 17.56 sq km","code":""},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"quamichan-lake-vancouver-island","dir":"Articles","previous_headings":"Locations","what":"Quamichan Lake, Vancouver Island","title":"Sensitivity Analysis","text":"EMS ID: E207466 Region: Vancouver Island Latitude: 48.8003 N Longitude: 123.6625 W Site Depth: 7 m Maximum Lake Depth: 8 m Lake Elevation: 25 m Lake Surface Area: 2.88 sq km","code":""},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"prepare-the-data-for-comparisons-including-setting-the-date-to-be-the-same","dir":"Articles","previous_headings":"Locations","what":"Prepare the data for comparisons, including setting the date to be the same","title":"Sensitivity Analysis","text":"sites:","code":"sites <- sites_sf |>    st_drop_geometry() sites <- sites |>    mutate(date = \"2023-08-01\") gt(sites)"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"basic-analysis-using-defaults","dir":"Articles","previous_headings":"","what":"Basic analysis using defaults","title":"Sensitivity Analysis","text":"perform sensitivity analysis, need define function, multi_tuv() allows us repeated runs TUV model PLC50 calculation using range inputs range sites: use multi_tuv() function calculate \\(P_{abs}\\), PLC50, ratio PLC50:NLC50 Anthracene using recorded DOC values three sites. also uses utility pahwq look ozone column aerosol optical depth climatologies based latitude, longitude, month. compare sites using input parameters location (lat, lon, elevation), modify data set constant [DOC] (DOC = 5), calculate \\(P_{abs}\\), PLC50, ratio PLC50:NLC50 Anthracene using constant DOC = 5:","code":"multi_tuv <- function(df, site = \"name\", pah, varying, vals = NULL, ...) {   if (!varying %in% union(names(tuv_aq_defaults()), names(formals(set_tuv_aq_params)))) {     stop(varying, \" is not a valid argument for `set_tuv_aq_params()`\")   }      if (!is.null(vals)) {     var_df <- data.frame(vals)     names(var_df) <- varying          df <- df |>        select(!any_of(varying)) |>        dplyr::cross_join(var_df)   }      df |>      rowwise() |>      mutate(       Pabs = calc_Pabs(           date = date,            lat = lat,            lon = lon,           elev_m = elev_m,           pah = pah,           varying = .data[[varying]],           vary_var = varying,           ...         ),       plc50 = plc50(Pabs, pah = pah),       plc_nlc_ratio = plc50 / nlc50(pah)     ) }  calc_Pabs <- function(date, lat, lon, elev_m, pah, varying, vary_var, ...) {   args <- c(     varying,      list(       depth_m = 0.25,       date = as.Date(date),       lat = lat,       lon = lon,       elev_km = elev_m / 1000     ),     ...   )   names(args)[1] <- vary_var      # allow overriding of one of the core args by one supplied in 'varying',    # this will keep the first of duplicated argument names, which will   # be the one in 'varying'   args <- args[unique(names(args))]      do.call(\"set_tuv_aq_params\", args)      run_tuv(quiet = TRUE)   res <- get_tuv_results(file = \"out_irrad_y\")   p_abs(res, pah) } diff_DOC <- multi_tuv(sites, pah = \"Anthracene\", varying = \"DOC\") same_DOC <- sites |>   mutate(DOC = 5) |>   multi_tuv(pah = \"Anthracene\", varying = \"DOC\")"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"light-attenuation-coefficicent-k_d","dir":"Articles","previous_headings":"","what":"Light Attenuation Coefficicent (\\(k_d\\))","title":"Sensitivity Analysis","text":"TUV model calculates light attenuation coefficient \\(k_d(λ)\\) wavelength, based reference \\(k_d(λ_{ref})\\), \\(\\lambda_{ref}\\) reference wavelength. \\(k_d(λ_{ref})\\) 305nm (\\(k_{d,305}\\)) can estimated Dissolved Organic Carbon concentration [DOC] using equation: \\(k_{d,305} = a_{305}[DOC]^{b_{305}} + 0.13\\); \\(a_{305}\\) = 2.76 \\(b_{305}\\) = 1.2 Morris et al. (1995); Equation 4-1a Jourabchi (2023) sensitivity analysis \\(k_d\\), interpretable supply range \\(k_d\\) values TUV model directly, even though practice likely use [DOC] estimate \\(k_d\\). test sensitivity \\(k_d\\) using sample values Table 3 (Jourabchi (2023)), 0.08 275:","code":"kd_vals <- seq(0.08, 275, length.out = 20)"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"effect-of-varying-k_d-on-plc50-and-ratio-of-plc50nlc50-for-anthracene","dir":"Articles","previous_headings":"Light Attenuation Coefficicent (\\(k_d\\))","what":"Effect of varying \\(k_d\\) on PLC50 and ratio of PLC50:NLC50 for Anthracene","title":"Sensitivity Analysis","text":"Anthracene, ratio PLC50:NLC50 approaches 1 \\(k_d(305)\\) ~ 250 — words level \\(k_d\\), PLC50 nearly NLC50, indicating light attenuated extent phototoxicity Anthracene activated light levels \\(k_d(305)\\) >= 250. According equation estimating \\(k_d\\) [DOC]: \\(250 = 2.76[DOC]^{1.23} + 0.13\\) [DOC] ~= 40 Therefore \\(k_d(305)\\) ~250 representative light attenuation [DOC] ~40. significantly higher DOC concentration observed three sample lakes, outside range equation recommended (recommended [DOC] 0.2 23 mg/L).","code":"kd_test_a <- multi_tuv(sites,                        pah = \"Anthracene\",                        varying = \"Kd_ref\",                        vals = kd_vals,                        Kd_wvl = 305,                       o3_tc = 300,                       tauaer = 0.235)  ggplot(kd_test_a, aes(x = Kd_ref, y = plc50)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +   theme_bw() +    labs(     title = TeX(r\"(PLC50 for Anthracene at 3 sites in B.C. for a range of $k_d(305)$)\"),      x = TeX(r\"($k_d(305)$)\"),     y = \"PLC50 (μg/L)\"     ) ggplot(kd_test_a, aes(x = Kd_ref, y = plc_nlc_ratio)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +   theme_bw() +    labs(     title = TeX(r\"(Ratio of PLC50:NLC50 for Anthracene at 3 sites in B.C. for a range of $k_d(305)$)\"),      x = TeX(r\"($k_d(305)$)\"),     y = \"Ratio of PLC50:NLC50\"     )"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"effect-of-varying-k_d-on-plc50-and-ratio-of-plc50nlc50-for-benzoapyrene","dir":"Articles","previous_headings":"Light Attenuation Coefficicent (\\(k_d\\))","what":"Effect of varying \\(k_d\\) on PLC50 and ratio of PLC50:NLC50 for Benzo[a]pyrene","title":"Sensitivity Analysis","text":"use input values Anthracene:","code":"kd_test_b <- multi_tuv(sites,                        pah = \"Benzo[a]pyrene\",                        varying = \"Kd_ref\",                        vals = kd_vals,                       o3_tc = 300,                       tauaer = 0.235)  ggplot(kd_test_b, aes(x = Kd_ref, y = plc50)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +   theme_bw() +    labs(     title = TeX(r\"(PLC50 for Benzo\\[a\\]pyrene at 3 sites in B.C. for a range of $k_d(305)$)\"),      x = TeX(r\"($k_d(305)$)\"),     y = \"PLC50 (μg/L)\"     ) ggplot(kd_test_b, aes(x = Kd_ref, y = plc_nlc_ratio)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +   theme_bw() +    labs(     title = TeX(r\"(Ratio of PLC50:NLC50 for Benzo\\[a\\]pyrene at 3 sites in B.C. for a range of $k_d(305)$)\"),      x = TeX(r\"($k_d(305)$)\"),     y = \"Ratio of PLC50:NLC50\"     )"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"surface-albedo-albedo","dir":"Articles","previous_headings":"","what":"Surface Albedo (albedo)","title":"Sensitivity Analysis","text":"test surface albedo values 0.05 0.1 (typical water), include suggested default 0.7: set DOC = 5 sites ensure constant \\(k_d\\) value, test range surface albedo values three sites Anthracene Benzo[]pyrene.","code":"albedo_vals <- c(seq(0.05, 0.1, length.out = 10), 0.07)"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"effect-of-varying-surface-albedo-on-plc50-and-ratio-of-plc50nlc50-for-anthracene","dir":"Articles","previous_headings":"Surface Albedo (albedo)","what":"Effect of varying Surface Albedo on PLC50 and ratio of PLC50:NLC50 for Anthracene","title":"Sensitivity Analysis","text":"","code":"albedo_test_a <- multi_tuv(sites,                        pah = \"Anthracene\",                        varying = \"albedo\",                        vals = albedo_vals,                       DOC = 5,                       o3_tc = 300,                       tauaer = 0.235)  ggplot(albedo_test_a, aes(x = albedo, y = plc50)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +   geom_point(     data = filter(albedo_test_a, albedo == 0.07),      aes(x = albedo, y = plc50),     colour = \"red\"   ) +    geom_text_repel(     data = filter(albedo_test_a, albedo == 0.07, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = albedo, y = plc50),     colour = \"red\",      label = \"Recommended default = 0.07\",     nudge_x = 0.001,     nudge_y = 0.1   ) +   theme_bw() +    labs(     title = \"PLC50 for Anthracene at 3 sites in B.C. for a range of Surface Albedo\",      x = \"Surface Albedo\",     y = \"PLC50 (μg/L)\"   ) ggplot(albedo_test_a, aes(x = albedo, y = plc_nlc_ratio)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +     geom_point(     data = filter(albedo_test_a, albedo == 0.07),      aes(x = albedo, y = plc_nlc_ratio),     colour = \"red\"   ) +    geom_text_repel(     data = filter(albedo_test_a, albedo == 0.07, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = albedo, y = plc_nlc_ratio),     colour = \"red\",      label = \"Recommended default = 0.07\",     nudge_x = 0.001,     nudge_y = 0.0005   ) +   theme_bw() +    labs(     title = \"Ratio of PLC50:NLC50 for Anthracene at 3 sites in B.C. for a range of Surface Albedo\",      x = \"Surface Albedo\",     y = \"Ratio of PLC50:NLC50\"     )"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"effect-of-varying-surface-albedo-on-plc50-and-ratio-of-plc50nlc50-for-benzoapyrene","dir":"Articles","previous_headings":"Surface Albedo (albedo)","what":"Effect of varying Surface Albedo on PLC50 and ratio of PLC50:NLC50 for Benzo[a]pyrene","title":"Sensitivity Analysis","text":"","code":"albedo_test_b <- multi_tuv(sites,                        pah = \"Benzo[a]pyrene\",                        varying = \"albedo\",                        vals = albedo_vals,                       DOC = 5,                       o3_tc = 300,                       tauaer = 0.235)  ggplot(albedo_test_b, aes(x = albedo, y = plc50)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +     geom_point(     data = filter(albedo_test_b, albedo == 0.07),      aes(x = albedo, y = plc50),     colour = \"red\"   ) +    geom_text_repel(     data = filter(albedo_test_b, albedo == 0.07, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = albedo, y = plc50),     colour = \"red\",      label = \"Recommended default = 0.07\",     nudge_x = 0.001,     nudge_y = 0.1   ) +   theme_bw() +    labs(     title = \"PLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Surface Albedo\",      x = \"Surface Albedo\",     y = \"PLC50 (μg/L)\"     ) ggplot(albedo_test_b, aes(x = albedo, y = plc_nlc_ratio)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +     geom_point(     data = filter(albedo_test_b, albedo == 0.07),      aes(x = albedo, y = plc_nlc_ratio),     colour = \"red\"   ) +    geom_text_repel(     data = filter(albedo_test_b, albedo == 0.07, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = albedo, y = plc_nlc_ratio),     colour = \"red\",      label = \"Recommended default = 0.07\",     nudge_x = 0.001,     nudge_y = 0.0003   ) +   theme_bw() +    labs(     title = \"Ratio of PLC50:NLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Surface Albedo\",      x = \"Surface Albedo\",     y = \"Ratio of PLC50:NLC50\"     )"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"ozone-column-o3_tc","dir":"Articles","previous_headings":"","what":"Ozone Column (o3_tc)","title":"Sensitivity Analysis","text":"pahwq package currently uses average monthly ozone column data 1980-1991 Fortuin Kelder (1998), bundled TUV model. Based latitude longitude month, ozone column value looked supplied TUV model. default behaviour can overridden supplying value o3_tc argument set_tuv_aq_params function. absence climatological data, recommended default value 300 DU (Jourabchi (2023)). test sensitivity PLC50 ozone column, range values tested 280-420 DU, typical values middle Northern latitudes. See NASA’s ‘Ozone Watch’ page information atmospheric ozone.","code":"ozone_vals <- seq(280, 420, by = 10)"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"effect-of-varying-ozone-total-column-on-plc50-and-ratio-of-plc50nlc50-for-anthracene","dir":"Articles","previous_headings":"Ozone Column (o3_tc)","what":"Effect of varying Ozone Total Column on PLC50 and ratio of PLC50:NLC50 for Anthracene","title":"Sensitivity Analysis","text":"","code":"ozone_test_a <- multi_tuv(sites,                        pah = \"Anthracene\",                        varying = \"o3_tc\",                        vals = ozone_vals,                       DOC = 5,                       tauaer = 0.235)  ggplot(ozone_test_a, aes(x = o3_tc, y = plc50)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +   geom_point(     data = filter(ozone_test_a, o3_tc == 300),      aes(x = o3_tc, y = plc50),     colour = \"red\"   ) +    geom_text_repel(     data = filter(ozone_test_a, o3_tc == 300, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = o3_tc, y = plc50),     colour = \"red\",      label = \"Recommended default = 300\"   ) +   theme_bw() +    labs(     title = \"PLC50 for Anthracene at 3 sites in B.C. for a range of Ozone Total Column\",      x = \"Ozone Total Column\",     y = \"PLC50 (μg/L)\"   ) ggplot(ozone_test_a, aes(x = o3_tc, y = plc_nlc_ratio)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +     geom_point(     data = filter(ozone_test_a, o3_tc == 300),      aes(x = o3_tc, y = plc_nlc_ratio),     colour = \"red\"   ) +    geom_text_repel(     data = filter(ozone_test_a, o3_tc == 300, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = o3_tc, y = plc_nlc_ratio),     colour = \"red\",      label = \"Recommended default = 300\"   ) +   theme_bw() +    labs(     title = \"Ratio of PLC50:NLC50 for Anthracene at 3 sites in B.C. for a range of Ozone Total Column\",      x = \"Ozone Total Column\",     y = \"Ratio of PLC50:NLC50\"     )"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"effect-of-varying-ozone-total-column-on-plc50-and-ratio-of-plc50nlc50-for-benzoapyrene","dir":"Articles","previous_headings":"Ozone Column (o3_tc)","what":"Effect of varying Ozone Total Column on PLC50 and ratio of PLC50:NLC50 for Benzo[a]pyrene","title":"Sensitivity Analysis","text":"","code":"ozone_test_b <- multi_tuv(sites,                        pah = \"Benzo[a]pyrene\",                        varying = \"o3_tc\",                        vals = ozone_vals,                       DOC = 5,                       tauaer = 0.235)  ggplot(ozone_test_b, aes(x = o3_tc, y = plc50)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +   geom_point(     data = filter(ozone_test_b, o3_tc == 300),      aes(x = o3_tc, y = plc50),     colour = \"red\"   ) +    geom_text_repel(     data = filter(ozone_test_b, o3_tc == 300, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = o3_tc, y = plc50),     colour = \"red\",      label = \"Recommended default = 300\"   ) +   theme_bw() +    labs(     title = \"PLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Ozone Total Column\",      x = \"Ozone Total Column\",     y = \"PLC50 (μg/L)\"   ) ggplot(ozone_test_b, aes(x = o3_tc, y = plc_nlc_ratio)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +     geom_point(     data = filter(ozone_test_b, o3_tc == 300),      aes(x = o3_tc, y = plc_nlc_ratio),     colour = \"red\"   ) +    geom_text_repel(     data = filter(ozone_test_b, o3_tc == 300, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = o3_tc, y = plc_nlc_ratio),     colour = \"red\",      label = \"Recommended default = 300\"   ) +   theme_bw() +    labs(     title = \"Ratio of PLC50:NLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Ozone Total Column\",      x = \"Ozone Total Column\",     y = \"Ratio of PLC50:NLC50\"     )"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"aerosol-optical-depth-tauaer","dir":"Articles","previous_headings":"","what":"Aerosol Optical Depth (tauaer)","title":"Sensitivity Analysis","text":"pahwq package currently uses average monthly aerosol optical depth data 2002 2023, obtained MODIS/Aqua satellite data. Based latitude longitude month, AOD value looked supplied TUV model. default behaviour can overridden supplying value tauaer argument set_tuv_aq_params function. absence climatological data, recommended default value 0.235 (Jourabchi (2023)). test sensitivity PLC50 AOD, range values tested 0.1 (clear skies maximum visibility) 1.0 (hazy skies). See NASA Earth Observatory page aerosols.","code":"aod_vals <- c(seq(0.1, 1.0, length.out = 10), 0.235)"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"effect-of-varying-aerosol-optical-depth-aod-on-plc50-and-ratio-of-plc50nlc50-for-anthracene","dir":"Articles","previous_headings":"Aerosol Optical Depth (tauaer)","what":"Effect of Varying Aerosol Optical Depth (AOD) on PLC50 and ratio of PLC50:NLC50 for Anthracene","title":"Sensitivity Analysis","text":"","code":"aod_test_a <- multi_tuv(sites,                        pah = \"Anthracene\",                        varying = \"tauaer\",                        vals = aod_vals,                       DOC = 5,                       o3_tc = 300)  ggplot(aod_test_a, aes(x = tauaer, y = plc50)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +   geom_point(     data = filter(aod_test_a, tauaer == 0.235),      aes(x = tauaer, y = plc50),     colour = \"red\"   ) +    geom_text_repel(     data = filter(aod_test_a, tauaer == 0.235, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = tauaer, y = plc50),     colour = \"red\",      label = \"Recommended default = 0.235\",     nudge_y = 0.1   ) +   theme_bw() +    labs(     title = \"PLC50 for Anthracene at 3 sites in B.C. for a range of Aeorosol Optical Depth\",      x = \"Aeorosol Optical Depth\",     y = \"PLC50 (μg/L)\"   ) ggplot(aod_test_a, aes(x = tauaer, y = plc_nlc_ratio)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +   geom_point(     data = filter(aod_test_a, tauaer == 0.235),      aes(x = tauaer, y = plc_nlc_ratio),     colour = \"red\"   ) +    geom_text_repel(     data = filter(aod_test_a, tauaer == 0.235, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = tauaer, y = plc_nlc_ratio),     colour = \"red\",      label = \"Recommended default = 0.235\",     nudge_y = 0.002   ) +   theme_bw() +    labs(     title = \"Ratio of PLC50:NLC50 for Anthracene at 3 sites in B.C. for a range of Aeorosol Optical Depth\",      x = \"Aeorosol Optical Depth\",     y = \"Ratio of PLC50:NLC50\"     )"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"effect-of-varying-aerosol-optical-depth-aod-on-plc50-and-ratio-of-plc50nlc50-for-benzoapyrene","dir":"Articles","previous_headings":"Aerosol Optical Depth (tauaer)","what":"Effect of varying Aerosol Optical Depth (AOD) on PLC50 and ratio of PLC50:NLC50 for Benzo[a]pyrene","title":"Sensitivity Analysis","text":"","code":"aod_test_b <- multi_tuv(sites,                        pah = \"Benzo[a]pyrene\",                        varying = \"tauaer\",                        vals = aod_vals,                       DOC = 5,                       o3_tc = 300)  ggplot(aod_test_b, aes(x = tauaer, y = plc50)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +   geom_point(     data = filter(aod_test_b, tauaer == 0.235),      aes(x = tauaer, y = plc50),     colour = \"red\"   ) +    geom_text_repel(     data = filter(aod_test_b, tauaer == 0.235, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = tauaer, y = plc50),     colour = \"red\",      label = \"Recommended default = 0.235\",     nudge_y = 0.002   ) +   theme_bw() +    labs(     title = \"PLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Aeorosol Optical Depth\",      x = \"Aeorosol Optical Depth\",     y = \"PLC50 (μg/L)\"   ) ggplot(aod_test_b, aes(x = tauaer, y = plc_nlc_ratio)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +     geom_point(     data = filter(aod_test_b, tauaer == 0.235),      aes(x = tauaer, y = plc_nlc_ratio),     colour = \"red\"   ) +    geom_text_repel(     data = filter(aod_test_b, tauaer == 0.235, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = tauaer, y = plc_nlc_ratio),     colour = \"red\",      label = \"Recommended default = 0.235\",     nudge_y = 0.001   ) +   theme_bw() +    labs(     title = \"Ratio of PLC50:NLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Aeorosol Optical Depth\",      x = \"Aeorosol Optical Depth\",     y = \"Ratio of PLC50:NLC50\"     )"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"aerosol-single-scattering-albedo-ssaaer","dir":"Articles","previous_headings":"","what":"Aerosol Single Scattering Albedo (ssaaer)","title":"Sensitivity Analysis","text":"Aerosol Single Scattering Albedo currently set default constant value 0.99. can overridden setting ssaaer parameter set_tuv_aq_params() function different value. test range values 0.80 0.99, including recommended default 0.99 (Jourabchi (2023)).","code":"ssa_vals <- seq(0.8, 0.99, length.out = 10)"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"effect-of-varying-aerosol-single-scattering-albedo-on-plc50-and-ratio-of-plc50nlc50-for-anthracene","dir":"Articles","previous_headings":"Aerosol Single Scattering Albedo (ssaaer)","what":"Effect of varying Aerosol Single Scattering Albedo on PLC50 and ratio of PLC50:NLC50 for Anthracene","title":"Sensitivity Analysis","text":"","code":"ssa_test_a <- multi_tuv(sites,                        pah = \"Anthracene\",                        varying = \"ssaaer\",                        vals = ssa_vals,                       DOC = 5,                       o3_tc = 300,                       tauaer = 0.235)  ggplot(ssa_test_a, aes(x = ssaaer, y = plc50)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +     facet_wrap(vars(name), ncol = 1) +   geom_point(     data = filter(ssa_test_a, ssaaer == 0.99),      aes(x = ssaaer, y = plc50),     colour = \"red\"   ) +    geom_text_repel(     data = filter(ssa_test_a, ssaaer == 0.99, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = ssaaer, y = plc50),     colour = \"red\",      label = \"Recommended default = 0.99\",     nudge_y = .06   ) +   theme_bw() +    labs(     title = \"PLC50 for Anthracene at 3 sites in B.C. for a range of Aeorosol Single Scattering Albedo\",      x = \"Aeorosol Single Scattering Albedo\",     y = \"PLC50 (μg/L)\"   ) ggplot(ssa_test_a, aes(x = ssaaer, y = plc_nlc_ratio)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +     geom_point(     data = filter(ssa_test_a, ssaaer == 0.99),      aes(x = ssaaer, y = plc_nlc_ratio),     colour = \"red\"   ) +    geom_text_repel(     data = filter(ssa_test_a, ssaaer == 0.99, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = ssaaer, y = plc_nlc_ratio),     colour = \"red\",      label = \"Recommended default = 0.99\",     nudge_y = .001   ) +   theme_bw() +    labs(     title = \"Ratio of PLC50:NLC50 for Anthracene at 3 sites in B.C. for a range of Aeorosol Single Scattering Albedo\",      x = \"Aeorosol Single Scattering Albedo\",     y = \"Ratio of PLC50:NLC50\"     )"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"effect-of-varying-aerosol-single-scattering-albedo-on-plc50-and-ratio-of-plc50nlc50-for-benzoapyrene","dir":"Articles","previous_headings":"Aerosol Single Scattering Albedo (ssaaer)","what":"Effect of varying Aerosol Single Scattering Albedo on PLC50 and ratio of PLC50:NLC50 for Benzo[a]pyrene","title":"Sensitivity Analysis","text":"","code":"ssa_test_b <- multi_tuv(sites,                        pah = \"Benzo[a]pyrene\",                        varying = \"ssaaer\",                        vals = ssa_vals,                       DOC = 5,                       o3_tc = 300,                       tauaer = 0.235)  ggplot(ssa_test_b, aes(x = ssaaer, y = plc50)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +     geom_point(     data = filter(ssa_test_b, ssaaer == 0.99),      aes(x = ssaaer, y = plc50),     colour = \"red\"   ) +    geom_text_repel(     data = filter(ssa_test_b, ssaaer == 0.99, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = ssaaer, y = plc50),     colour = \"red\",      label = \"Recommended default = 0.99\",     nudge_y = .001   ) +   theme_bw() +    labs(     title = \"PLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Aeorosol Single Scattering Albedo\",      x = \"Aeorosol Single Scattering Albedo\",     y = \"PLC50 (μg/L)\"   ) ggplot(ssa_test_b, aes(x = ssaaer, y = plc_nlc_ratio)) +   geom_point() +    facet_wrap(vars(name), ncol = 1) +       geom_point(     data = filter(ssa_test_b, ssaaer == 0.99),      aes(x = ssaaer, y = plc_nlc_ratio),     colour = \"red\"   ) +    geom_text_repel(     data = filter(ssa_test_b, ssaaer == 0.99, name == \"QUAMICHAN LAKE; CENTRE\"),      aes(x = ssaaer, y = plc_nlc_ratio),     colour = \"red\",      label = \"Recommended default = 0.99\",     nudge_y = .0005   ) +   theme_bw() +    labs(     title = \"Ratio of PLC50:NLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Aeorosol Single Scattering Albedo\",      x = \"Aeorosol Single Scattering Albedo\",     y = \"Ratio of PLC50:NLC50\"     )"},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"latitude","dir":"Articles","previous_headings":"","what":"Latitude","title":"Sensitivity Analysis","text":"Latitude strong effect angle sun, turn affect light penetration water, thus important investigate sensitivity calculation PLC50 variation latitude. analysis, maintain longitudes associated site, make “mock” sites creating range latitudes 48 72 degrees N pair longitudes original sites.","code":"lat_vals <- seq(48, 72, by = 2) lat_test_a <- multi_tuv(sites,                        pah = \"Anthracene\",                        varying = \"lat\",                        vals = lat_vals,                       DOC = 5,                       o3_tc = 300,                       tauaer = 0.235)  ggplot(lat_test_a, aes(x = lat, y = plc50)) +   geom_point() +    facet_wrap(vars(lon), ncol = 1, labeller = as_labeller(\\(x) paste(\"Longitude: \", x))) +   theme_bw() +    labs(     title = \"PLC50 for Anthracene at 3 sites in B.C. for a range of latitudes\",      x = \"latitudes\",     y = \"PLC50 (μg/L)\"   ) ggplot(lat_test_a, aes(x = lat, y = plc_nlc_ratio)) +   geom_point() +    facet_wrap(vars(lon), ncol = 1, labeller = as_labeller(\\(x) paste(\"Longitude: \", x))) +   theme_bw() +    labs(     title = \"Ratio of PLC50:NLC50 for Anthracene at 3 sites in B.C. for a range of latitudes\",     x = \"latitudes\",     y = \"Ratio of PLC50:NLC50\"     )"},{"path":[]},{"path":[]},{"path":"https://bcgov.github.io/pahwq/articles/sensitivity.html","id":"nstr","dir":"Articles","previous_headings":"","what":"nstr","title":"Sensitivity Analysis","text":"","code":"multi_tuv(sites,            pah = \"Anthracene\",            varying = \"nstr\",            vals = c(-2, 4),            DOC = 5,           o3_tc = 300,           tauaer = 0.235) #> # A tibble: 6 × 13 #> # Rowwise:  #>   emsid   name    lon   lat elev_m date    DOC doc_min doc_max  nstr  Pabs plc50 #>   <chr>   <chr> <dbl> <dbl>  <dbl> <chr> <dbl>   <dbl>   <dbl> <dbl> <dbl> <dbl> #> 1 0400390 CHAR… -121.  56.3    693 2023… 14       0.96   15.4     -2  341.  2.39 #> 2 0400390 CHAR… -121.  56.3    693 2023… 14       0.96   15.4      4  336.  2.40 #> 3 0500236 OKAN… -120.  49.9    342 2023…  4.26    4.06    5.17    -2  369.  2.31 #> 4 0500236 OKAN… -120.  49.9    342 2023…  4.26    4.06    5.17     4  364.  2.32 #> 5 E207466 QUAM… -124.  48.8     25 2023…  6.61    6.37   11.8     -2  371.  2.31 #> 6 E207466 QUAM… -124.  48.8     25 2023…  6.61    6.37   11.8      4  365.  2.32 #> # ℹ 1 more variable: plc_nlc_ratio <dbl>"},{"path":[]},{"path":"https://bcgov.github.io/pahwq/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Andy Teucher. Author, maintainer. Province British Columbia. Copyright holder. National Center Atmospheric Research. Copyright holder.            TUV model Canadian Council Ministers Environment. Copyright holder.            Modifications TUV model","code":""},{"path":"https://bcgov.github.io/pahwq/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Teucher (2023). pahwq: Calculate site-specific water quality guidelines PAHs. R package version 0.0.0.9000, https://bcgov.github.io/pahwq/, https://github.com/bcgov/pahwq.","code":"@Manual{,   title = {pahwq: Calculate site-specific water quality guidelines for PAHs},   author = {Andy Teucher},   year = {2023},   note = {R package version 0.0.0.9000, https://bcgov.github.io/pahwq/},   url = {https://github.com/bcgov/pahwq}, }"},{"path":[]},{"path":"https://bcgov.github.io/pahwq/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Calculate site-specific water quality guidelines for PAHs","text":"Implementation Photoxic Lipid Model (PTLM) calculation Canadian Water Quality Guidelines Polycyclic Aromatic Hydrocarbons (PAH). package uses Tropospheric Ultraviolet Visible (TUV) Radiation Model (https://github.com/NCAR/TUV) calculate light penetration water given depth given location, specified Dissolved Organic Carbon concentration. light exposure used (along PAH-specific molar absorption across range wavelengths), calculate light absorption (Pabs) given PAH location. used determine PLC50.","code":""},{"path":"https://bcgov.github.io/pahwq/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Calculate site-specific water quality guidelines for PAHs","text":"order install package need compiler toolchain installed computer (specifically gfortran) compile Fortran code TUV model.","code":""},{"path":"https://bcgov.github.io/pahwq/index.html","id":"windows","dir":"","previous_headings":"Installation","what":"Windows","title":"Calculate site-specific water quality guidelines for PAHs","text":"Windows, need install Rtools. Make sure install appropriate version version R (.e. Rtools 4.0 R 4.0.x, Rtools 4.3 R 4.3.x, etc.).","code":""},{"path":"https://bcgov.github.io/pahwq/index.html","id":"mac","dir":"","previous_headings":"Installation","what":"Mac","title":"Calculate site-specific water quality guidelines for PAHs","text":"Mac, easiest way get started use Homebrew, install gcc, includes gfortran:","code":"brew install gcc"},{"path":"https://bcgov.github.io/pahwq/index.html","id":"install-pahwq","dir":"","previous_headings":"Installation","what":"Install pahwq","title":"Calculate site-specific water quality guidelines for PAHs","text":"Rtools (Windows) gcc (Mac), can install package : Note: may get warnings install package - Fortran compiler Fortran code quite old fully conform modern standards. warnings affect package functionality accuracy.","code":"# install.packages(\"pak\") pak::pak(\"bcgov/pahwq\")"},{"path":"https://bcgov.github.io/pahwq/index.html","id":"example-usage","dir":"","previous_headings":"","what":"Example usage","title":"Calculate site-specific water quality guidelines for PAHs","text":"calculate acute phototoxic water quality guideline (PLC50) Anthracene 0.25 m depth Okanagan Lake June 21, 2023, measured DOC 5 g/m^3, can use following code: Load pahwq package: Set options TUV model run: Run TUV model Get results TUV model run, data.frame incident irradiation timestamp wavelength, given water depth: Calculate value Pabs PAH interest, using results TUV model run: Finally, calculate PLC50 PAH interest can compare PLC50 NLC50 see effect photoxicity PAH:","code":"library(pahwq) set_tuv_aq_params(   depth_m = 0.25,   lat = 49.601632,   lon = -119.605862,   elev_km = 0.342,   DOC = 5,   date = \"2023-06-21\",   tzone = -8L ) run_tuv() res <- get_tuv_results(file = \"out_irrad_y\") head(res) #>    wl wavelength_start wavelength_end Kd_lambda t_00.00.00 t_01.00.00 #> 1 280            279.5          280.5      31.5          0          0 #> 2 281            280.5          281.5      31.0          0          0 #> 3 282            281.5          282.5      30.4          0          0 #> 4 283            282.5          283.5      29.9          0          0 #> 5 284            283.5          284.5      29.3          0          0 #> 6 285            284.5          285.5      28.8          0          0 #>   t_02.00.00 t_03.00.00 t_04.00.00 t_05.00.00 t_06.00.00 t_07.00.00 t_08.00.00 #> 1          0          0   3.17e-38   1.00e-37   1.90e-37   4.44e-37   7.97e-34 #> 2          0          0   3.22e-35   1.02e-34   1.94e-34   4.63e-34   6.16e-31 #> 3          0          0   3.75e-32   1.18e-31   2.27e-31   5.57e-31   5.40e-28 #> 4          0          0   1.84e-30   5.81e-30   1.12e-29   2.80e-29   2.26e-26 #> 5          0          0   2.20e-28   6.93e-28   1.35e-27   3.47e-27   2.17e-24 #> 6          0          0   1.75e-26   5.52e-26   1.09e-25   2.90e-25   1.37e-22 #>   t_09.00.00 t_10.00.00 t_11.00.00 t_12.00.00 t_13.00.00 t_14.00.00 t_15.00.00 #> 1   3.54e-29   2.17e-26   6.85e-25   2.05e-24   6.97e-25   2.26e-26   3.79e-29 #> 2   1.04e-26   3.66e-24   8.58e-23   2.34e-22   8.73e-23   3.79e-24   1.11e-26 #> 3   3.42e-24   6.75e-22   1.17e-20   2.91e-20   1.19e-20   6.98e-22   3.62e-24 #> 4   8.17e-23   1.16e-20   1.69e-19   3.97e-19   1.72e-19   1.20e-20   8.62e-23 #> 5   3.72e-21   3.41e-19   3.95e-18   8.63e-18   4.01e-18   3.51e-19   3.90e-21 #> 6   1.08e-19   6.34e-18   5.79e-17   1.17e-16   5.86e-17   6.50e-18   1.13e-19 #>   t_16.00.00 t_17.00.00 t_18.00.00 t_19.00.00 t_20.00.00 t_21.00.00 t_22.00.00 #> 1   8.94e-34   4.49e-37   1.91e-37   1.01e-37   3.22e-38          0          0 #> 2   6.84e-31   4.69e-34   1.95e-34   1.02e-34   3.28e-35          0          0 #> 3   5.93e-28   5.64e-31   2.29e-31   1.19e-31   3.81e-32          0          0 #> 4   2.46e-26   2.83e-29   1.13e-29   5.84e-30   1.87e-30          0          0 #> 5   2.35e-24   3.51e-27   1.36e-27   6.97e-28   2.24e-28          0          0 #> 6   1.47e-22   2.94e-25   1.10e-25   5.56e-26   1.78e-26          0          0 #>   t_23.00.00 #> 1          0 #> 2          0 #> 3          0 #> 4          0 #> 5          0 #> 6          0 (Pabs <- p_abs(res, \"Anthracene\")) #> [1] 451.0696 plc50(Pabs, pah = \"Anthracene\") #> [1] 2.128409 nlc50(\"Anthracene\") #> [1] 58.40685"},{"path":"https://bcgov.github.io/pahwq/index.html","id":"options","dir":"","previous_headings":"Example usage","what":"Options","title":"Calculate site-specific water quality guidelines for PAHs","text":"pahwq creates directory computer store TUV model input output files. default, location set automatically standard location (determined tools::R_user_dir). can change location directory setting pahwq.tuv_data_dir option:","code":"options(\"pahwq.tuv_data_dir\" = \"path/to/my/tuv/data\")"},{"path":"https://bcgov.github.io/pahwq/index.html","id":"getting-help-or-reporting-an-issue","dir":"","previous_headings":"Example usage","what":"Getting Help or Reporting an Issue","title":"Calculate site-specific water quality guidelines for PAHs","text":"report bugs/issues/feature requests, please file issue.","code":""},{"path":"https://bcgov.github.io/pahwq/index.html","id":"how-to-contribute","dir":"","previous_headings":"Example usage","what":"How to Contribute","title":"Calculate site-specific water quality guidelines for PAHs","text":"like contribute package, please see CONTRIBUTING guidelines. Please note project released Contributor Code Conduct. participating project agree abide terms.","code":""},{"path":"https://bcgov.github.io/pahwq/index.html","id":"license","dir":"","previous_headings":"Example usage","what":"License","title":"Calculate site-specific water quality guidelines for PAHs","text":"","code":"Copyright 2023 Province of British Columbia  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in compliance with the License. You may obtain a copy of the License at  http://www.apache.org/licenses/LICENSE-2.0  Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License."},{"path":"https://bcgov.github.io/pahwq/reference/clean_tuv_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"Delete the directory containing the TUV files — clean_tuv_dir","title":"Delete the directory containing the TUV files — clean_tuv_dir","text":"Delete directory containing TUV files","code":""},{"path":"https://bcgov.github.io/pahwq/reference/clean_tuv_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Delete the directory containing the TUV files — clean_tuv_dir","text":"","code":"clean_tuv_dir(tuv_dir = tuv_data_dir())"},{"path":"https://bcgov.github.io/pahwq/reference/clean_tuv_dir.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Delete the directory containing the TUV files — clean_tuv_dir","text":"tuv_dir directory containing TUV files","code":""},{"path":"https://bcgov.github.io/pahwq/reference/get_tuv_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve results of TUV run — get_tuv_results","title":"Retrieve results of TUV run — get_tuv_results","text":"Retrieve results TUV run","code":""},{"path":"https://bcgov.github.io/pahwq/reference/get_tuv_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve results of TUV run — get_tuv_results","text":"","code":"get_tuv_results(file = \"out_irrad_y\", tuv_dir = tuv_data_dir())"},{"path":"https://bcgov.github.io/pahwq/reference/get_tuv_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve results of TUV run — get_tuv_results","text":"file one \"out_irrad_y\", \"out_aflux_y\", \"out_irrad_ave\", \"out_aflux_ave\", \"out_irrad_atm\", \"out_aflux_atm\" tuv_dir directory compiled TUV executable located","code":""},{"path":"https://bcgov.github.io/pahwq/reference/get_tuv_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve results of TUV run — get_tuv_results","text":"data.frame results TUV run","code":""},{"path":"https://bcgov.github.io/pahwq/reference/kd_305.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Kd at 305 nm for a given Dissolved Organic Carbon (DOC) concentration. — kd_305","title":"Calculate Kd at 305 nm for a given Dissolved Organic Carbon (DOC) concentration. — kd_305","text":"Calculate Kd 305 nm given Dissolved Organic Carbon (DOC) concentration.","code":""},{"path":"https://bcgov.github.io/pahwq/reference/kd_305.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Kd at 305 nm for a given Dissolved Organic Carbon (DOC) concentration. — kd_305","text":"","code":"kd_305(DOC)"},{"path":"https://bcgov.github.io/pahwq/reference/kd_305.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Kd at 305 nm for a given Dissolved Organic Carbon (DOC) concentration. — kd_305","text":"DOC DOC g/m^3","code":""},{"path":"https://bcgov.github.io/pahwq/reference/kd_305.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Kd at 305 nm for a given Dissolved Organic Carbon (DOC) concentration. — kd_305","text":"numeric vector representing Kd 305 nm","code":""},{"path":"https://bcgov.github.io/pahwq/reference/kd_305.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Kd at 305 nm for a given Dissolved Organic Carbon (DOC) concentration. — kd_305","text":"","code":"kd_305(5) #> [1] 20.11"},{"path":"https://bcgov.github.io/pahwq/reference/kd_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Kd at a given wavelength and DOC concentration. — kd_lambda","title":"Calculate Kd at a given wavelength and DOC concentration. — kd_lambda","text":"Note function used inside package calculation done Fortran TUV model. present demonstration purposes.","code":""},{"path":"https://bcgov.github.io/pahwq/reference/kd_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Kd at a given wavelength and DOC concentration. — kd_lambda","text":"","code":"kd_lambda(DOC, wavelength)"},{"path":"https://bcgov.github.io/pahwq/reference/kd_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Kd at a given wavelength and DOC concentration. — kd_lambda","text":"DOC DOC g/m^3 wavelength lambda wavelength nm","code":""},{"path":"https://bcgov.github.io/pahwq/reference/kd_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Kd at a given wavelength and DOC concentration. — kd_lambda","text":"numeric vector representin Kd given wavelength","code":""},{"path":"https://bcgov.github.io/pahwq/reference/kd_lambda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Kd at a given wavelength and DOC concentration. — kd_lambda","text":"","code":"kd_lambda(10, 400) #> 400  #> 8.5"},{"path":"https://bcgov.github.io/pahwq/reference/list_tuv_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"Delete the directory containing the TUV files — list_tuv_dir","title":"Delete the directory containing the TUV files — list_tuv_dir","text":"Delete directory containing TUV files","code":""},{"path":"https://bcgov.github.io/pahwq/reference/list_tuv_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Delete the directory containing the TUV files — list_tuv_dir","text":"","code":"list_tuv_dir(tuv_dir = tuv_data_dir())"},{"path":"https://bcgov.github.io/pahwq/reference/list_tuv_dir.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Delete the directory containing the TUV files — list_tuv_dir","text":"tuv_dir directory containing TUV files","code":""},{"path":"https://bcgov.github.io/pahwq/reference/nlc50.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the NLC50 value for a PAH or HAC using the Target Lipid Model (TLM) — nlc50","title":"Calculate the NLC50 value for a PAH or HAC using the Target Lipid Model (TLM) — nlc50","text":"uses equation default values McGrath et al. 2018.","code":""},{"path":"https://bcgov.github.io/pahwq/reference/nlc50.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the NLC50 value for a PAH or HAC using the Target Lipid Model (TLM) — nlc50","text":"","code":"nlc50(chemical, slope = -0.94, HC5 = 9.3, dc_pah = -0.364, dc_hac = -0.471)"},{"path":"https://bcgov.github.io/pahwq/reference/nlc50.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the NLC50 value for a PAH or HAC using the Target Lipid Model (TLM) — nlc50","text":"chemical chemical (HAC PAH) interest slope slope Equation 1 McGrath et al. 2018. default value -0.94, taken Table 3 McGrath et al. 2018. recommended adjust without good justification. HC5 5th percentile SSD critical body burdens predicted hazardous 5% species. Default value 9.3 umol/g, calculated using Equation 3 McGrath et al 2018. recommended adjust without good justification. dc_pah Chemical class correction (Δc) PAHs, reported McGrath et al. 2018. dc_hac Chemical class correction (Δc) HACs, reported McGrath et al. 2021.","code":""},{"path":"https://bcgov.github.io/pahwq/reference/nlc50.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the NLC50 value for a PAH or HAC using the Target Lipid Model (TLM) — nlc50","text":"NLC50 value, ug/L","code":""},{"path":"https://bcgov.github.io/pahwq/reference/nlc50.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate the NLC50 value for a PAH or HAC using the Target Lipid Model (TLM) — nlc50","text":"McGrath, J.., Fanelli, C.J., Di Toro, D.M., Parkerton, T.F., Redman, .D., Paumen, M.L., Comber, M., Eadsforth, C.V. den Haan, K. (2018), Re-evaluation target lipid model–derived HC5 predictions hydrocarbons. Environ Toxicol Chem, 37: 1579-1593. https://doi.org/10.1002/etc.4100 McGrath, J., Getzinger, G., Redman, .D., Edwards, M., Martin Aparicio, . Vaiopoulou, E. (2021), Application Target Lipid Model Assess Toxicity Heterocyclic Aromatic Compounds Aquatic Organisms. Environ Toxicol Chem, 40: 3000-3009. https://doi.org/10.1002/etc.5194","code":""},{"path":"https://bcgov.github.io/pahwq/reference/nlc50.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the NLC50 value for a PAH or HAC using the Target Lipid Model (TLM) — nlc50","text":"","code":"nlc50(\"anthracene\") #> [1] 58.40685"},{"path":"https://bcgov.github.io/pahwq/reference/p_abs.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the Light absorption of a PAH from results of the TUV model. — p_abs","title":"Calculate the Light absorption of a PAH from results of the TUV model. — p_abs","text":"Calculate Light absorption PAH results TUV model.","code":""},{"path":"https://bcgov.github.io/pahwq/reference/p_abs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the Light absorption of a PAH from results of the TUV model. — p_abs","text":"","code":"p_abs(tuv_results, PAH, time_delta = 1, time_multiplier = 2)"},{"path":"https://bcgov.github.io/pahwq/reference/p_abs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the Light absorption of a PAH from results of the TUV model. — p_abs","text":"tuv_results data.frame TUV results PAH name PAH calculate light absorption time_delta number hours time step TUV results time_multiplier multiplier get total exposure time. .e., tuv_results contains 24 hours data, need 48 exposure, multiplier 2. (default)","code":""},{"path":"https://bcgov.github.io/pahwq/reference/p_abs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the Light absorption of a PAH from results of the TUV model. — p_abs","text":"value Pabs TUV results.","code":""},{"path":"https://bcgov.github.io/pahwq/reference/plc50.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the PLC50 for a given Pabs and NLC50. — plc50","title":"Calculate the PLC50 for a given Pabs and NLC50. — plc50","text":"PLC50 LC50 phototoxic PAH based calculations site-specific field-level light absorption.","code":""},{"path":"https://bcgov.github.io/pahwq/reference/plc50.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the PLC50 for a given Pabs and NLC50. — plc50","text":"","code":"plc50(p_abs, pah = NULL, NLC50 = NULL)"},{"path":"https://bcgov.github.io/pahwq/reference/plc50.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the PLC50 for a given Pabs and NLC50. — plc50","text":"p_abs light absorption, calculated p_abs() pah PAH interest, used look NLC50. NLC50 (optional) narcotic toxicity (.e., absence light) PAH ug/L. supplied, takes precedence PAH lookup.","code":""},{"path":"https://bcgov.github.io/pahwq/reference/plc50.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the PLC50 for a given Pabs and NLC50. — plc50","text":"PLC50 PAH.","code":""},{"path":"https://bcgov.github.io/pahwq/reference/plc50.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate the PLC50 for a given Pabs and NLC50. — plc50","text":"can either supply specific PAH, NLC50 can looked chemical, supply NLC50 value directly.","code":""},{"path":"https://bcgov.github.io/pahwq/reference/plc50.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the PLC50 for a given Pabs and NLC50. — plc50","text":"","code":"plc50(590, pah = \"Benzo[a]pyrene\") #> [1] 0.05979498 plc50(590, NLC50 = 450) #> [1] 14.68394"},{"path":"https://bcgov.github.io/pahwq/reference/run_tuv.html","id":null,"dir":"Reference","previous_headings":"","what":"Call the TUV program — run_tuv","title":"Call the TUV program — run_tuv","text":"must set tuv parameters calling set_tuv_aq_params() calling run_tuv()","code":""},{"path":"https://bcgov.github.io/pahwq/reference/run_tuv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Call the TUV program — run_tuv","text":"","code":"run_tuv(tuv_dir = tuv_data_dir(), quiet = FALSE)"},{"path":"https://bcgov.github.io/pahwq/reference/run_tuv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Call the TUV program — run_tuv","text":"tuv_dir directory compiled TUV executable located quiet progress TUV program printed console?","code":""},{"path":"https://bcgov.github.io/pahwq/reference/set_tuv_aq_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Set required and optional parameters for TUV — set_tuv_aq_params","title":"Set required and optional parameters for TUV — set_tuv_aq_params","text":"Set required optional parameters TUV","code":""},{"path":"https://bcgov.github.io/pahwq/reference/set_tuv_aq_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set required and optional parameters for TUV — set_tuv_aq_params","text":"","code":"set_tuv_aq_params(   depth_m = NULL,   lat = NULL,   lon = NULL,   elev_km = NULL,   date = NULL,   Kd_ref = NULL,   Kd_wvl = NULL,   DOC = NULL,   tzone = 0L,   tstart = 0,   tstop = 23,   tsteps = 24L,   wvl_start = 280,   wvl_end = 420,   wvl_steps = wvl_end - wvl_start + 1,   o3_tc = NULL,   tauaer = NULL,   ...,   write = TRUE,   tuv_dir = tuv_data_dir() )"},{"path":"https://bcgov.github.io/pahwq/reference/set_tuv_aq_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set required and optional parameters for TUV — set_tuv_aq_params","text":"depth_m depth calculate light attenuation coefficient. Required. lat latitude site, decimal degrees. Required. lon longitude site, decimal degrees. Required. elev_km elevation site sea level, kilometres. Required. date date calculation, Date object, character standard format can converted Date object (e.g., \"YYYY-MM-DD\"). Required. Kd_ref Light attenuation coefficient reference wavelength. Can set directly, calculated DOC. Kd_wvl reference wavelength Kd_ref obtained, nm. Default 305. used Kd_ref set. DOC dissolved organic carbon concentration, mg/L. Ignored Kd_ref set directly. tzone timezone offset UTC, hours. Default 0. tstart start time calculation, hours. Default 0. tstop stop time calculation, hours. Default 23. tsteps number time steps calculate. Default 24. wvl_start start wavelength calculation, nm. Default 280. wvl_end end wavelength calculation, nm. Default 400. wvl_steps number wavelength steps calculate. Default 1 step per nm wvl_start wvl_end, inclusive. o3_tc ozone column, Dobson Units. NULL, looked based latitude month, based historic climatology. historic value given month location, default value 300 used. can force use default setting value parameter string \"default\". tauaer aerosol optical depth (tau) 550 nm. NULL, looked based latitude, longitude, month, based historic climatology. historic value given month location, default value 0.235 used. can force use default setting value parameter string \"default\". ... options passed TUV model. See tuv_aq_defaults() write options written inp_aq TUV directory? Default TRUE. tuv_dir directory compiled TUV executable located","code":""},{"path":"https://bcgov.github.io/pahwq/reference/set_tuv_aq_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set required and optional parameters for TUV — set_tuv_aq_params","text":"options character vector, invisibly","code":""},{"path":[]},{"path":"https://bcgov.github.io/pahwq/reference/set_tuv_aq_params.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set required and optional parameters for TUV — set_tuv_aq_params","text":"","code":"# Setting DOC set_tuv_aq_params(  depth_m = 0.25,  lat = 49.601632,  lon = -119.605862,  elev_km = 0.342,  DOC = 5,  date = \"2023-06-21\" ) # Setting Kd directly (with a different reference wavelength) set_tuv_aq_params(  depth_m = 0.25,  lat = 49.601632,  lon = -119.605862,  elev_km = 0.342,  Kd_ref = 40,  Kd_wvl = 280,  date = \"2023-06-21\" )"},{"path":"https://bcgov.github.io/pahwq/reference/tuv_aq_defaults.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a list of TUV inputs and their default values — tuv_aq_defaults","title":"Get a list of TUV inputs and their default values — tuv_aq_defaults","text":"Inputs default value thus required specified set_tup_options() shown empty vector required data type.","code":""},{"path":"https://bcgov.github.io/pahwq/reference/tuv_aq_defaults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a list of TUV inputs and their default values — tuv_aq_defaults","text":"","code":"tuv_aq_defaults()"},{"path":"https://bcgov.github.io/pahwq/reference/tuv_aq_defaults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a list of TUV inputs and their default values — tuv_aq_defaults","text":"list TUV inputs default values","code":""},{"path":"https://bcgov.github.io/pahwq/reference/tuv_run_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Show the input parameters used for a TUV model run — tuv_run_params","title":"Show the input parameters used for a TUV model run — tuv_run_params","text":"Show input parameters used TUV model run","code":""},{"path":"https://bcgov.github.io/pahwq/reference/tuv_run_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show the input parameters used for a TUV model run — tuv_run_params","text":"","code":"tuv_run_params(x)"},{"path":"https://bcgov.github.io/pahwq/reference/tuv_run_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show the input parameters used for a TUV model run — tuv_run_params","text":"x tuv results, result running run_tuv()","code":""},{"path":"https://bcgov.github.io/pahwq/reference/tuv_run_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show the input parameters used for a TUV model run — tuv_run_params","text":"named character vector inputs TUV model","code":""},{"path":"https://bcgov.github.io/pahwq/reference/view_tuv_aq_params.html","id":null,"dir":"Reference","previous_headings":"","what":"View TUV aquatics options, as set by set_tuv_aq_params() — view_tuv_aq_params","title":"View TUV aquatics options, as set by set_tuv_aq_params() — view_tuv_aq_params","text":"View TUV aquatics options, set set_tuv_aq_params()","code":""},{"path":"https://bcgov.github.io/pahwq/reference/view_tuv_aq_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"View TUV aquatics options, as set by set_tuv_aq_params() — view_tuv_aq_params","text":"","code":"view_tuv_aq_params(as_character = FALSE, tuv_dir = tuv_data_dir())"},{"path":"https://bcgov.github.io/pahwq/reference/view_tuv_aq_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"View TUV aquatics options, as set by set_tuv_aq_params() — view_tuv_aq_params","text":"as_character Return character vector? Default FALSE, case just prints parameter list screen. tuv_dir directory compiled TUV executable located","code":""}]
