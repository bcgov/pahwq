<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pahwq">
<title>Sensitivity Analysis • pahwq</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sensitivity Analysis">
<meta property="og:description" content="pahwq">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pahwq</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/sensitivity.html">Sensitivity Analysis</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bcgov/pahwq/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="sensitivity_files/htmlwidgets-1.6.3/htmlwidgets.js"></script><link href="sensitivity_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="sensitivity_files/leaflet-1.3.1/leaflet.js"></script><link href="sensitivity_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="sensitivity_files/proj4-2.6.2/proj4.min.js"></script><script src="sensitivity_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="sensitivity_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="sensitivity_files/leaflet-binding-2.2.1/leaflet.js"></script><script src="sensitivity_files/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script><script src="sensitivity_files/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script><link href="sensitivity_files/HomeButton-0.0.1/home-button.css" rel="stylesheet">
<script src="sensitivity_files/HomeButton-0.0.1/home-button.js"></script><script src="sensitivity_files/HomeButton-0.0.1/easy-button-src.min.js"></script><script src="sensitivity_files/clipboard-0.0.1/setClipboardText.js"></script><link href="sensitivity_files/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet">
<link href="sensitivity_files/mapviewCSS-0.0.1/mapview.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Sensitivity Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bcgov/pahwq/blob/HEAD/vignettes/articles/sensitivity.Rmd" class="external-link"><code>vignettes/articles/sensitivity.Rmd</code></a></small>
      <div class="d-none name"><code>sensitivity.Rmd</code></div>
    </div>

    
    
<p>This report is to document the sensitivity of the TUV model, and the
subsequent calculation of water quality guidelines for PAHs, to
variation in certain PAH parameters.</p>
<div class="section level2">
<h2 id="input-parameters">Input parameters<a class="anchor" aria-label="anchor" href="#input-parameters"></a>
</h2>
<p>The input parameters for the calculation of light attenuation through
water for the TUV model are:</p>
<ul>
<li>Vertical Attenuation Coefficient at wavelength <code>wvl</code>:
<span class="math inline">\(kvat = k_de^{-Sk(ref\_wvl-wvl)}\)</span>
<ul>
<li>
<strong><code>Kd</code></strong> Light attenuation coefficient (set
directly or calculated from DOC)</li>
<li>
<strong><code>Sk</code></strong> (default <code>0.018</code>)</li>
<li>
<strong><code>ref_wvl</code></strong> Reference wavelength for
<code>Kd</code> (default <code>305</code>)</li>
</ul>
</li>
<li>
<strong><code>depth_m</code></strong> Water depth in m</li>
<li>
<strong><code>lat</code></strong> Latitude in decimal degrees</li>
<li>
<strong><code>lon</code></strong> Longitude in decimal degrees</li>
<li>
<strong><code>elev_km</code></strong> Surface elevation, km above
sea level</li>
<li>
<strong><code>year</code></strong> Year</li>
<li>
<strong><code>month</code></strong> Month</li>
<li>
<strong><code>day</code></strong> Day</li>
<li>
<strong><code>tzone</code></strong> Timezone Local Time - UTC
(default <code>0</code>; UTC)</li>
<li>
<strong><code>tstart</code></strong> Start time, hours local time
(default <code>0</code>)</li>
<li>
<strong><code>tstop</code></strong> Stop time, hours local time
(default <code>23</code>)</li>
<li>
<strong><code>tsteps</code></strong> Number of time steps (default
<code>24</code>)</li>
<li>
<strong><code>albedo</code></strong> Surface albedo (default
<code>0.07</code>)</li>
<li>
<strong><code>o3_tc</code></strong> Ozone column, Dobson Units (DU)
- Looked up in climatology (recommended default <code>300</code>)</li>
<li>
<strong><code>so2_tc</code></strong> SO2 column, DU (default
<code>0</code>)</li>
<li>
<strong><code>no2_tc</code></strong> NO2 column, DU (default
<code>0</code>)</li>
<li>
<strong><code>taucld</code></strong> Cloud optical depth (default
<code>0</code>)</li>
<li>
<strong><code>zbase</code></strong> Cloud base, km (default
<code>4</code>)</li>
<li>
<strong><code>ztop</code></strong> Cloud top, km (default
<code>5</code>)</li>
<li>
<strong><code>tauaer</code></strong> Aerosol optical depth at 550 nm
- Looked up in climatology (recommended default <code>0.235</code>)</li>
<li>
<strong><code>ssaaer</code></strong> Aerosol single scattering
albedo (default <code>0.990</code>)</li>
<li>
<strong><code>alpha</code></strong> Aerosol Angstrom
exponent(default <code>1.0</code>)</li>
<li>
<strong><code>wvl_start</code></strong> Starting wavelength, nm
(default <code>279.5</code>)</li>
<li>
<strong><code>wvl_end</code></strong> End wavelength, nm (default
<code>400.5</code>)</li>
<li>
<strong><code>wvl_steps</code></strong> Number of wavelength
intervals (default <code>121</code>)</li>
<li>
<strong><code>nstr</code></strong> TUV run type; use -2 for fast, 4
for slightly more accurate (default <code>-2</code>)</li>
</ul>
<p>Those currently under consideration for sensitivity analysis are:</p>
<ul>
<li>
<strong><code>Kd</code></strong> Light attenuation coefficient -
includes use of <strong><code>DOC</code></strong> for calculating
<code>Kd</code>
</li>
<li>
<strong><code>lat</code></strong> Latitude in decimal degrees</li>
<li>
<strong><code>lon</code></strong> Longitude in decimal degrees</li>
<li>
<strong><code>elev_km</code></strong> Surface elevation, km above
sea level</li>
<li>
<strong><code>albedo</code></strong> Surface albedo (default
<code>0.07</code>)</li>
<li>
<strong><code>o3_tc</code></strong> Ozone column, Dobson Units (DU)
- Looked up in climatology (recommended default <code>300</code>)</li>
<li>
<strong><code>tauaer</code></strong> Aerosol optical depth at 550 nm
- Looked up in climatology (recommended default <code>0.235</code>)</li>
<li>
<strong><code>ssaaer</code></strong> Aerosol single scattering
albedo (default <code>0.990</code>)</li>
<li>
<strong><code>nstr</code></strong> TUV run type; use -2 for fast, 4
for slightly more accurate (default <code>-2</code>)</li>
</ul>
<p>The analyses will be conducted at three different sample lakes
(Southern Interior, Vancouver Island, Northeast), using two PAHs
(Anthracene and Benzo[a]pyrene).</p>
<p>Initially, sensitivity analyses will be univariate (varying the input
of interest while holding the others constant). If there are significant
interactions expected between certain variables, these can be
explored.</p>
</div>
<div class="section level2">
<h2 id="basic-usage-of-the-pahwq-package">Basic usage of the <code>pahwq</code> package<a class="anchor" aria-label="anchor" href="#basic-usage-of-the-pahwq-package"></a>
</h2>
<p>To calculate the acute phototoxic water quality guideline (PLC50) for
Anthracene at 0.25 m depth in Okanagan Lake on June 21, 2023, with a
measured DOC of 5 g/m^3, you would use the following code:</p>
<p>First, set up the options for the model run:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bcgov/pahwq" class="external-link">pahwq</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/set_tuv_aq_params.html">set_tuv_aq_params</a></span><span class="op">(</span></span>
<span>  depth_m <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  lat <span class="op">=</span> <span class="fl">49.601632</span>,</span>
<span>  lon <span class="op">=</span> <span class="op">-</span><span class="fl">119.605862</span>,</span>
<span>  elev_km <span class="op">=</span> <span class="fl">0.342</span>,</span>
<span>  DOC <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  date <span class="op">=</span> <span class="st">"2023-06-21"</span>,</span>
<span>  tzone <span class="op">=</span> <span class="op">-</span><span class="fl">8</span>,</span>
<span>  albedo <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You can view the options that will be used by TUV. Some are set via
the function inputs, and some are looked up:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/view_tuv_aq_params.html">view_tuv_aq_params</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; a,b,c for: kvdom = a exp(-b(wvl-c)). a = kd(305), b = Sk, c = wavelength, wvl = 305: 20.11 0.018 305</span></span>
<span><span class="co">#&gt; ydepth, m: 0.25</span></span>
<span><span class="co">#&gt; lat, negative S of Equator: 49.601632</span></span>
<span><span class="co">#&gt; lon, negative W of Greenwich (zero) meridian: -119.605862</span></span>
<span><span class="co">#&gt; surface elevation, km above sea level: 0.342</span></span>
<span><span class="co">#&gt; timezone: Local Time - UTC: -8</span></span>
<span><span class="co">#&gt; iyear: 2023</span></span>
<span><span class="co">#&gt; imonth: 6</span></span>
<span><span class="co">#&gt; iday: 21</span></span>
<span><span class="co">#&gt; tstart, hours local time: 0</span></span>
<span><span class="co">#&gt; tstop, hours local time: 23</span></span>
<span><span class="co">#&gt; number of time steps: 24</span></span>
<span><span class="co">#&gt; surface albedo: 0.05</span></span>
<span><span class="co">#&gt; o3_tc  ozone column, Dobson Units (DU): 359.937</span></span>
<span><span class="co">#&gt; so2_tc SO2 column, DU: 0</span></span>
<span><span class="co">#&gt; no2_tc NO2 column, DU: 0</span></span>
<span><span class="co">#&gt; taucld - cloud optical depth: 0</span></span>
<span><span class="co">#&gt; zbase - cloud base, km: 4</span></span>
<span><span class="co">#&gt; ztop - cloud top, km: 5</span></span>
<span><span class="co">#&gt; tauaer - aerosol optical depth at 550 nm: 0.0641989811085006</span></span>
<span><span class="co">#&gt; ssaaer - aerosol single scattering albedo: 0.99</span></span>
<span><span class="co">#&gt; alpha - aerosol Angstrom exponent: 1</span></span>
<span><span class="co">#&gt; starting wavelength, nm: 279.5</span></span>
<span><span class="co">#&gt; end wavelength, nm: 420.5</span></span>
<span><span class="co">#&gt; number of wavelength intervals: 141</span></span>
<span><span class="co">#&gt; nstr, use -2 for fast, 4 for slightly more accurate: -2</span></span>
<span><span class="co">#&gt; out_irrad_y, T/F, planar spectral irradiance at ydepth: T</span></span>
<span><span class="co">#&gt; out_aflux_y, T/F, scalar spectral irradiance (actinic flux)  at depth: T</span></span>
<span><span class="co">#&gt; out_irrad_ave, T/F, planar irrad., averaged 0-ydepth: T</span></span>
<span><span class="co">#&gt; out_aflux_ave, T/F, scalar, ave 0-ydepth: T</span></span>
<span><span class="co">#&gt; out_irrad_atm, T/F, planar, in atmosphere: T</span></span>
<span><span class="co">#&gt; out_aflux_atm, T/F, scalar, in atmosphere: T</span></span></code></pre></div>
<p>Run the TUV model and get the results. The results show the
underwater irradiance at the specified depth, at each wavelength and
time step.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/run_tuv.html">run_tuv</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the results</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_tuv_results.html">get_tuv_results</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"out_irrad_y"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt;    wl wavelength_start wavelength_end Kd_lambda t_00.00.00 t_01.00.00</span></span>
<span><span class="co">#&gt; 1 280            279.5          280.5      31.5          0          0</span></span>
<span><span class="co">#&gt; 2 281            280.5          281.5      31.0          0          0</span></span>
<span><span class="co">#&gt; 3 282            281.5          282.5      30.4          0          0</span></span>
<span><span class="co">#&gt; 4 283            282.5          283.5      29.9          0          0</span></span>
<span><span class="co">#&gt; 5 284            283.5          284.5      29.3          0          0</span></span>
<span><span class="co">#&gt; 6 285            284.5          285.5      28.8          0          0</span></span>
<span><span class="co">#&gt;   t_02.00.00 t_03.00.00 t_04.00.00 t_05.00.00 t_06.00.00 t_07.00.00 t_08.00.00</span></span>
<span><span class="co">#&gt; 1          0          0   3.16e-38   1.00e-37   1.90e-37   4.44e-37   7.97e-34</span></span>
<span><span class="co">#&gt; 2          0          0   3.21e-35   1.02e-34   1.94e-34   4.63e-34   6.16e-31</span></span>
<span><span class="co">#&gt; 3          0          0   3.74e-32   1.18e-31   2.27e-31   5.57e-31   5.39e-28</span></span>
<span><span class="co">#&gt; 4          0          0   1.84e-30   5.80e-30   1.12e-29   2.79e-29   2.25e-26</span></span>
<span><span class="co">#&gt; 5          0          0   2.19e-28   6.92e-28   1.35e-27   3.47e-27   2.16e-24</span></span>
<span><span class="co">#&gt; 6          0          0   1.75e-26   5.52e-26   1.09e-25   2.90e-25   1.36e-22</span></span>
<span><span class="co">#&gt;   t_09.00.00 t_10.00.00 t_11.00.00 t_12.00.00 t_13.00.00 t_14.00.00 t_15.00.00</span></span>
<span><span class="co">#&gt; 1   3.54e-29   2.17e-26   6.84e-25   2.05e-24   6.97e-25   2.26e-26   3.79e-29</span></span>
<span><span class="co">#&gt; 2   1.04e-26   3.65e-24   8.57e-23   2.34e-22   8.72e-23   3.79e-24   1.11e-26</span></span>
<span><span class="co">#&gt; 3   3.42e-24   6.74e-22   1.17e-20   2.90e-20   1.19e-20   6.97e-22   3.62e-24</span></span>
<span><span class="co">#&gt; 4   8.16e-23   1.16e-20   1.69e-19   3.97e-19   1.72e-19   1.20e-20   8.61e-23</span></span>
<span><span class="co">#&gt; 5   3.71e-21   3.41e-19   3.95e-18   8.62e-18   4.00e-18   3.51e-19   3.90e-21</span></span>
<span><span class="co">#&gt; 6   1.08e-19   6.33e-18   5.78e-17   1.17e-16   5.85e-17   6.49e-18   1.13e-19</span></span>
<span><span class="co">#&gt;   t_16.00.00 t_17.00.00 t_18.00.00 t_19.00.00 t_20.00.00 t_21.00.00 t_22.00.00</span></span>
<span><span class="co">#&gt; 1   8.93e-34   4.49e-37   1.91e-37   1.01e-37   3.22e-38          0          0</span></span>
<span><span class="co">#&gt; 2   6.83e-31   4.68e-34   1.95e-34   1.02e-34   3.27e-35          0          0</span></span>
<span><span class="co">#&gt; 3   5.92e-28   5.63e-31   2.28e-31   1.19e-31   3.81e-32          0          0</span></span>
<span><span class="co">#&gt; 4   2.46e-26   2.83e-29   1.13e-29   5.83e-30   1.87e-30          0          0</span></span>
<span><span class="co">#&gt; 5   2.34e-24   3.51e-27   1.36e-27   6.97e-28   2.23e-28          0          0</span></span>
<span><span class="co">#&gt; 6   1.46e-22   2.94e-25   1.09e-25   5.55e-26   1.78e-26          0          0</span></span>
<span><span class="co">#&gt;   t_23.00.00</span></span>
<span><span class="co">#&gt; 1          0</span></span>
<span><span class="co">#&gt; 2          0</span></span>
<span><span class="co">#&gt; 3          0</span></span>
<span><span class="co">#&gt; 4          0</span></span>
<span><span class="co">#&gt; 5          0</span></span>
<span><span class="co">#&gt; 6          0</span></span></code></pre></div>
<p>Calculate the site-specific light absorption (<span class="math inline">\(P_{abs}\)</span>) for Anthracene from the TUV
results. The <code><a href="../reference/p_abs.html">p_abs()</a></code> function uses a lookup table to get
the molar absorption coefficient for the specified PAH.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">Pabs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/p_abs.html">p_abs</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"Anthracene"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 448.6275</span></span></code></pre></div>
<p>Finally, calculate PLC50 in 𝝁g/L, supplying the <span class="math inline">\(P_{abs}\)</span> value and NLC50 (𝝁g/L):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plc_50.html">plc_50</a></span><span class="op">(</span><span class="va">Pabs</span>, pah <span class="op">=</span> <span class="st">"Anthracene"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.133157</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>We’ll start by loading the packages we need and getting some data
from B.C. EMS:</p>
<details><summary style='font-size:0.8em; margin-bottom:0; color: #666;&gt;
          Show/Hide Code
          &lt;/summary&gt;

```r
library(sf)
library(mapview)
library(rems)
library(dplyr)
library(ggplot2)
library(ggrepel)
library(latex2exp)

con &lt;- connect_historic_db()
db &lt;- attach_historic_data(con)
sites_sf &lt;- db |&gt; 
  filter(
    EMS_ID %in% c("0500236", "E207466", "0400390"),
    # grepl("(CHARLIE L)|(OKANAGAN)|(QUAMICHAN)", MONITORING_LOCATION), 
    COLLECTION_START &gt; as.Date("2020-01-01"), PARAMETER_CODE == "1103"
  ) |&gt; 
  collect() |&gt; 
  st_as_sf(coords = c("LONGITUDE", "LATITUDE"), crs = 4326, remove = FALSE) |&gt; 
  filter(!is.na(RESULT)) |&gt; 
  arrange(desc(COLLECTION_START)) |&gt; 
  group_by(EMS_ID, MONITORING_LOCATION, LONGITUDE, LATITUDE) |&gt; 
  mutate(doc_min = min(RESULT), doc_max = max(RESULT)) |&gt; 
  slice(1) |&gt; 
  select(emsid = EMS_ID, 
         name = MONITORING_LOCATION, 
         lon = LONGITUDE, 
         lat = LATITUDE, 
         date = COLLECTION_START, 
         DOC = RESULT,
         doc_min,
         doc_max) |&gt; 
  left_join(
    tribble(
      ~ emsid, ~elev_m,
      "E207466", 25,
      "0400390", 693,
      "0500236", 342
    ), by = join_by("emsid")
  ) |&gt; 
  ungroup() |&gt; 
  relocate(elev_m, .after = lat)

disconnect_historic_db(con)
```

&lt;/details&gt;


## Locations
&lt;details&gt;
          &lt;summary style=' font-size:0.8em margin-bottom:0 color:>
          Show/Hide Code
          </summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mapview</span><span class="op">(</span><span class="va">sites_sf</span>, zcol <span class="op">=</span> <span class="st">"name"</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</details><div class="leaflet html-widget html-fill-item" id="htmlwidget-1f299f6654115b45bf86" style="width:768px;height:768px;"></div>
<script type="application/json" data-for="htmlwidget-1f299f6654115b45bf86">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["point",440]},{"method":"addCircleMarkers","args":[[56.3125,49.8614,48.8003],[-120.9642,-119.5134,-123.6625],6,null,"sites_sf - name",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"point","stroke":true,"color":"#333333","weight":1,"opacity":[0.9,0.9,0.9],"fill":true,"fillColor":["#4B0055","#009B95","#FDE333"],"fillOpacity":[0.6,0.6,0.6]},null,null,["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>emsid&emsp;<\/th><td>0400390&emsp;<\/td><\/tr><tr><td>2<\/td><th>name&emsp;<\/th><td>CHARLIE L DEEP STATION 1.2 KM EAST OF PARK&emsp;<\/td><\/tr><tr><td>3<\/td><th>lon&emsp;<\/th><td>-120.9642&emsp;<\/td><\/tr><tr><td>4<\/td><th>lat&emsp;<\/th><td>56.3125&emsp;<\/td><\/tr><tr><td>5<\/td><th>elev_m&emsp;<\/th><td>693&emsp;<\/td><\/tr><tr><td>6<\/td><th>date&emsp;<\/th><td>2021-08-24 08:50:00&emsp;<\/td><\/tr><tr><td>7<\/td><th>DOC&emsp;<\/th><td>14.00&emsp;<\/td><\/tr><tr><td>8<\/td><th>doc_min&emsp;<\/th><td>0.96&emsp;<\/td><\/tr><tr><td>9<\/td><th>doc_max&emsp;<\/th><td>15.40&emsp;<\/td><\/tr><tr><td>10<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>emsid&emsp;<\/th><td>0500236&emsp;<\/td><\/tr><tr><td>2<\/td><th>name&emsp;<\/th><td>OKANAGAN L D/S KELOWNA STP (DEEP)&emsp;<\/td><\/tr><tr><td>3<\/td><th>lon&emsp;<\/th><td>-119.5134&emsp;<\/td><\/tr><tr><td>4<\/td><th>lat&emsp;<\/th><td>49.8614&emsp;<\/td><\/tr><tr><td>5<\/td><th>elev_m&emsp;<\/th><td>342&emsp;<\/td><\/tr><tr><td>6<\/td><th>date&emsp;<\/th><td>2021-09-08 11:00:00&emsp;<\/td><\/tr><tr><td>7<\/td><th>DOC&emsp;<\/th><td> 4.26&emsp;<\/td><\/tr><tr><td>8<\/td><th>doc_min&emsp;<\/th><td>4.06&emsp;<\/td><\/tr><tr><td>9<\/td><th>doc_max&emsp;<\/th><td> 5.17&emsp;<\/td><\/tr><tr><td>10<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>3&emsp;<\/td><\/tr><tr><td>1<\/td><th>emsid&emsp;<\/th><td>E207466&emsp;<\/td><\/tr><tr><td>2<\/td><th>name&emsp;<\/th><td>QUAMICHAN LAKE; CENTRE&emsp;<\/td><\/tr><tr><td>3<\/td><th>lon&emsp;<\/th><td>-123.6625&emsp;<\/td><\/tr><tr><td>4<\/td><th>lat&emsp;<\/th><td>48.8003&emsp;<\/td><\/tr><tr><td>5<\/td><th>elev_m&emsp;<\/th><td> 25&emsp;<\/td><\/tr><tr><td>6<\/td><th>date&emsp;<\/th><td>2021-08-25 11:00:00&emsp;<\/td><\/tr><tr><td>7<\/td><th>DOC&emsp;<\/th><td> 6.61&emsp;<\/td><\/tr><tr><td>8<\/td><th>doc_min&emsp;<\/th><td>6.37&emsp;<\/td><\/tr><tr><td>9<\/td><th>doc_max&emsp;<\/th><td>11.80&emsp;<\/td><\/tr><tr><td>10<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["CHARLIE L DEEP STATION 1.2 KM EAST OF PARK","OKANAGAN L D/S KELOWNA STP (DEEP)","QUAMICHAN LAKE; CENTRE"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-123.6625,48.8003,-119.5134,56.3125,true,"sites_sf - name","Zoom to sites_sf - name","<strong> sites_sf - name <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],"sites_sf - name",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[48.8003,56.3125],"lng":[-123.6625,-119.5134]},"fitBounds":[48.8003,-123.6625,56.3125,-119.5134,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script><div class="section level3">
<h3 id="okanagan-lake-okanagan">Okanagan Lake, Okanagan<a class="anchor" aria-label="anchor" href="#okanagan-lake-okanagan"></a>
</h3>
<ul>
<li>EMS ID: 0500236</li>
<li>Region: Okanagan</li>
<li>Latitude: 49.8614 N</li>
<li>Longitude: 119.5134 W</li>
<li>Site Depth: 70.1 m</li>
<li>Maximum Lake Depth: 232 m</li>
<li>Lake Elevation: 342 m</li>
<li>Lake Surface Area: 350.08 sq km</li>
</ul>
</div>
<div class="section level3">
<h3 id="charlie-lake-peace">Charlie Lake, Peace<a class="anchor" aria-label="anchor" href="#charlie-lake-peace"></a>
</h3>
<ul>
<li>EMS ID: 0400390</li>
<li>Region: Peace</li>
<li>Latitude: 56.3125 N</li>
<li>Longitude: 120.9642 W</li>
<li>Site Depth: 13 m</li>
<li>Maximum Lake Depth: 13 m</li>
<li>Lake Elevation: 693 m</li>
<li>Lake Surface Area: 17.56 sq km</li>
</ul>
</div>
<div class="section level3">
<h3 id="quamichan-lake-vancouver-island">Quamichan Lake, Vancouver Island<a class="anchor" aria-label="anchor" href="#quamichan-lake-vancouver-island"></a>
</h3>
<ul>
<li>EMS ID: E207466</li>
<li>Region: Vancouver Island</li>
<li>Latitude: 48.8003 N</li>
<li>Longitude: 123.6625 W</li>
<li>Site Depth: 7 m</li>
<li>Maximum Lake Depth: 8 m</li>
<li>Lake Elevation: 25 m</li>
<li>Lake Surface Area: 2.88 sq km</li>
</ul>
</div>
<div class="section level3">
<h3 id="prepare-the-data-for-comparisons-including-setting-the-date-to-be-the-same">Prepare the data for comparisons, including setting the date to be
the same<a class="anchor" aria-label="anchor" href="#prepare-the-data-for-comparisons-including-setting-the-date-to-be-the-same"></a>
</h3>
<p>for all sites:</p>
<details>
&lt;summary style=’font-size:0.8em; margin-bottom:0; color: #666;&gt;
Show/Hide Code

<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="va">sites_sf</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="va">sites</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>date <span class="op">=</span> <span class="st">"2023-08-01"</span><span class="op">)</span></span>
<span><span class="fu">gt</span><span class="op">(</span><span class="va">sites</span><span class="op">)</span></span></code></pre></div>
<div id="jgurfgyijx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jgurfgyijx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jgurfgyijx thead, #jgurfgyijx tbody, #jgurfgyijx tfoot, #jgurfgyijx tr, #jgurfgyijx td, #jgurfgyijx th {
  border-style: none;
}

#jgurfgyijx p {
  margin: 0;
  padding: 0;
}

#jgurfgyijx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jgurfgyijx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jgurfgyijx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jgurfgyijx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jgurfgyijx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jgurfgyijx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jgurfgyijx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jgurfgyijx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jgurfgyijx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jgurfgyijx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jgurfgyijx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jgurfgyijx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jgurfgyijx .gt_spanner_row {
  border-bottom-style: hidden;
}

#jgurfgyijx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jgurfgyijx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jgurfgyijx .gt_from_md > :first-child {
  margin-top: 0;
}

#jgurfgyijx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jgurfgyijx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jgurfgyijx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jgurfgyijx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jgurfgyijx .gt_row_group_first td {
  border-top-width: 2px;
}

#jgurfgyijx .gt_row_group_first th {
  border-top-width: 2px;
}

#jgurfgyijx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jgurfgyijx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jgurfgyijx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jgurfgyijx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jgurfgyijx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jgurfgyijx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jgurfgyijx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jgurfgyijx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jgurfgyijx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jgurfgyijx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jgurfgyijx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jgurfgyijx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jgurfgyijx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jgurfgyijx .gt_left {
  text-align: left;
}

#jgurfgyijx .gt_center {
  text-align: center;
}

#jgurfgyijx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jgurfgyijx .gt_font_normal {
  font-weight: normal;
}

#jgurfgyijx .gt_font_bold {
  font-weight: bold;
}

#jgurfgyijx .gt_font_italic {
  font-style: italic;
}

#jgurfgyijx .gt_super {
  font-size: 65%;
}

#jgurfgyijx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jgurfgyijx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jgurfgyijx .gt_indent_1 {
  text-indent: 5px;
}

#jgurfgyijx .gt_indent_2 {
  text-indent: 10px;
}

#jgurfgyijx .gt_indent_3 {
  text-indent: 15px;
}

#jgurfgyijx .gt_indent_4 {
  text-indent: 20px;
}

#jgurfgyijx .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="emsid">emsid</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="name">name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lon">lon</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lat">lat</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="elev_m">elev_m</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="date">date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="DOC">DOC</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="doc_min">doc_min</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="doc_max">doc_max</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="emsid" class="gt_row gt_left">0400390</td>
<td headers="name" class="gt_row gt_left">CHARLIE L DEEP STATION 1.2 KM EAST OF PARK</td>
<td headers="lon" class="gt_row gt_right">-120.9642</td>
<td headers="lat" class="gt_row gt_right">56.3125</td>
<td headers="elev_m" class="gt_row gt_right">693</td>
<td headers="date" class="gt_row gt_right">2023-08-01</td>
<td headers="DOC" class="gt_row gt_right">14.00</td>
<td headers="doc_min" class="gt_row gt_right">0.96</td>
<td headers="doc_max" class="gt_row gt_right">15.40</td>
</tr>
<tr>
<td headers="emsid" class="gt_row gt_left">0500236</td>
<td headers="name" class="gt_row gt_left">OKANAGAN L D/S KELOWNA STP (DEEP)</td>
<td headers="lon" class="gt_row gt_right">-119.5134</td>
<td headers="lat" class="gt_row gt_right">49.8614</td>
<td headers="elev_m" class="gt_row gt_right">342</td>
<td headers="date" class="gt_row gt_right">2023-08-01</td>
<td headers="DOC" class="gt_row gt_right">4.26</td>
<td headers="doc_min" class="gt_row gt_right">4.06</td>
<td headers="doc_max" class="gt_row gt_right">5.17</td>
</tr>
<tr>
<td headers="emsid" class="gt_row gt_left">E207466</td>
<td headers="name" class="gt_row gt_left">QUAMICHAN LAKE; CENTRE</td>
<td headers="lon" class="gt_row gt_right">-123.6625</td>
<td headers="lat" class="gt_row gt_right">48.8003</td>
<td headers="elev_m" class="gt_row gt_right">25</td>
<td headers="date" class="gt_row gt_right">2023-08-01</td>
<td headers="DOC" class="gt_row gt_right">6.61</td>
<td headers="doc_min" class="gt_row gt_right">6.37</td>
<td headers="doc_max" class="gt_row gt_right">11.80</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="basic-analysis-using-defaults">Basic analysis using defaults<a class="anchor" aria-label="anchor" href="#basic-analysis-using-defaults"></a>
</h2>
<p>We will first define a function, <code>multi_tuv()</code> that allows
us to do repeated runs of the TUV model and PLC50 calculation using a
range of inputs.</p>
<details>
&lt;summary style=’font-size:0.8em; margin-bottom:0; color: #666;&gt;
Show/Hide Code

<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multi_tuv</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">site</span> <span class="op">=</span> <span class="st">"name"</span>, <span class="va">pah</span>, <span class="va">varying</span>, <span class="va">vals</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">varying</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">union</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/tuv_aq_defaults.html">tuv_aq_defaults</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/formals.html" class="external-link">formals</a></span><span class="op">(</span><span class="va">set_tuv_aq_params</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="va">varying</span>, <span class="st">" is not a valid argument for `set_tuv_aq_params()`"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">vals</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">var_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">vals</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">var_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">varying</span></span>
<span>    </span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">select</span><span class="op">(</span><span class="op">!</span><span class="fu">any_of</span><span class="op">(</span><span class="va">varying</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/cross_join.html" class="external-link">cross_join</a></span><span class="op">(</span><span class="va">var_df</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span></span>
<span>      Pabs <span class="op">=</span> <span class="fu">calc_Pabs</span><span class="op">(</span></span>
<span>          date <span class="op">=</span> <span class="va">date</span>, </span>
<span>          lat <span class="op">=</span> <span class="va">lat</span>, </span>
<span>          lon <span class="op">=</span> <span class="va">lon</span>,</span>
<span>          elev_m <span class="op">=</span> <span class="va">elev_m</span>,</span>
<span>          pah <span class="op">=</span> <span class="va">pah</span>,</span>
<span>          varying <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">varying</span><span class="op">]</span><span class="op">]</span>,</span>
<span>          vary_var <span class="op">=</span> <span class="va">varying</span>,</span>
<span>          <span class="va">...</span></span>
<span>        <span class="op">)</span>,</span>
<span>      plc50 <span class="op">=</span> <span class="fu"><a href="../reference/plc_50.html">plc_50</a></span><span class="op">(</span><span class="va">Pabs</span>, pah <span class="op">=</span> <span class="va">pah</span><span class="op">)</span>,</span>
<span>      plc_nlc_ratio <span class="op">=</span> <span class="va">plc50</span> <span class="op">/</span> <span class="fu"><a href="../reference/nlc50.html">nlc50</a></span><span class="op">(</span><span class="va">pah</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">calc_Pabs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">date</span>, <span class="va">lat</span>, <span class="va">lon</span>, <span class="va">elev_m</span>, <span class="va">pah</span>, <span class="va">varying</span>, <span class="va">vary_var</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">varying</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      depth_m <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>      date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>      lat <span class="op">=</span> <span class="va">lat</span>,</span>
<span>      lon <span class="op">=</span> <span class="va">lon</span>,</span>
<span>      elev_km <span class="op">=</span> <span class="va">elev_m</span> <span class="op">/</span> <span class="fl">1000</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">args</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">vary_var</span></span>
<span>  </span>
<span>  <span class="co"># allow overriding of one of the core args by one supplied in 'varying', </span></span>
<span>  <span class="co"># this will keep the first of duplicated argument names, which will</span></span>
<span>  <span class="co"># be the one in 'varying'</span></span>
<span>  <span class="va">args</span> <span class="op">&lt;-</span> <span class="va">args</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">args</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"set_tuv_aq_params"</span>, <span class="va">args</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="../reference/run_tuv.html">run_tuv</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_tuv_results.html">get_tuv_results</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"out_irrad_y"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/p_abs.html">p_abs</a></span><span class="op">(</span><span class="va">res</span>, <span class="va">pah</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</details><p>We then use the <code>multi_tuv()</code> function to calculate <span class="math inline">\(P_{abs}\)</span>, PLC50, and ratio of PLC50:NLC50
for Anthracene using recorded DOC values at the three sites. This also
uses the utility of pahwq to look up ozone column and aerosol optical
depth from climatologies based on latitude, longitude, and month.</p>
<details>
&lt;summary style=’font-size:0.8em; margin-bottom:0; color: #666;&gt;
Show/Hide Code

<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diff_DOC</span> <span class="op">&lt;-</span> <span class="fu">multi_tuv</span><span class="op">(</span><span class="va">sites</span>, pah <span class="op">=</span> <span class="st">"Anthracene"</span>, varying <span class="op">=</span> <span class="st">"DOC"</span><span class="op">)</span></span></code></pre></div>
</details><div id="hnzljsgyof" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hnzljsgyof table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hnzljsgyof thead, #hnzljsgyof tbody, #hnzljsgyof tfoot, #hnzljsgyof tr, #hnzljsgyof td, #hnzljsgyof th {
  border-style: none;
}

#hnzljsgyof p {
  margin: 0;
  padding: 0;
}

#hnzljsgyof .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hnzljsgyof .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hnzljsgyof .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hnzljsgyof .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hnzljsgyof .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hnzljsgyof .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hnzljsgyof .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hnzljsgyof .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hnzljsgyof .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hnzljsgyof .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hnzljsgyof .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hnzljsgyof .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hnzljsgyof .gt_spanner_row {
  border-bottom-style: hidden;
}

#hnzljsgyof .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hnzljsgyof .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hnzljsgyof .gt_from_md > :first-child {
  margin-top: 0;
}

#hnzljsgyof .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hnzljsgyof .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hnzljsgyof .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hnzljsgyof .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hnzljsgyof .gt_row_group_first td {
  border-top-width: 2px;
}

#hnzljsgyof .gt_row_group_first th {
  border-top-width: 2px;
}

#hnzljsgyof .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hnzljsgyof .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hnzljsgyof .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hnzljsgyof .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hnzljsgyof .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hnzljsgyof .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hnzljsgyof .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hnzljsgyof .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hnzljsgyof .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hnzljsgyof .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hnzljsgyof .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hnzljsgyof .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hnzljsgyof .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hnzljsgyof .gt_left {
  text-align: left;
}

#hnzljsgyof .gt_center {
  text-align: center;
}

#hnzljsgyof .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hnzljsgyof .gt_font_normal {
  font-weight: normal;
}

#hnzljsgyof .gt_font_bold {
  font-weight: bold;
}

#hnzljsgyof .gt_font_italic {
  font-style: italic;
}

#hnzljsgyof .gt_super {
  font-size: 65%;
}

#hnzljsgyof .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hnzljsgyof .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hnzljsgyof .gt_indent_1 {
  text-indent: 5px;
}

#hnzljsgyof .gt_indent_2 {
  text-indent: 10px;
}

#hnzljsgyof .gt_indent_3 {
  text-indent: 15px;
}

#hnzljsgyof .gt_indent_4 {
  text-indent: 20px;
}

#hnzljsgyof .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="emsid">emsid</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="name">name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lon">lon</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lat">lat</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="elev_m">elev_m</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="date">date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="DOC">DOC</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Pabs">Pabs</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="plc50">plc50</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="plc_nlc_ratio">plc_nlc_ratio</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="emsid" class="gt_row gt_left">0400390</td>
<td headers="name" class="gt_row gt_left">CHARLIE L DEEP STATION 1.2 KM EAST OF PARK</td>
<td headers="lon" class="gt_row gt_right">-120.9642</td>
<td headers="lat" class="gt_row gt_right">56.3125</td>
<td headers="elev_m" class="gt_row gt_right">693</td>
<td headers="date" class="gt_row gt_right">2023-08-01</td>
<td headers="DOC" class="gt_row gt_right">14.00</td>
<td headers="Pabs" class="gt_row gt_right">4.678927</td>
<td headers="plc50" class="gt_row gt_right" style="background-color: #00441B; color: #FFFFFF;">12.228584</td>
<td headers="plc_nlc_ratio" class="gt_row gt_right">0.20936901</td>
</tr>
<tr>
<td headers="emsid" class="gt_row gt_left">0500236</td>
<td headers="name" class="gt_row gt_left">OKANAGAN L D/S KELOWNA STP (DEEP)</td>
<td headers="lon" class="gt_row gt_right">-119.5134</td>
<td headers="lat" class="gt_row gt_right">49.8614</td>
<td headers="elev_m" class="gt_row gt_right">342</td>
<td headers="date" class="gt_row gt_right">2023-08-01</td>
<td headers="DOC" class="gt_row gt_right">4.26</td>
<td headers="Pabs" class="gt_row gt_right">530.384085</td>
<td headers="plc50" class="gt_row gt_right" style="background-color: #F7FCF5; color: #000000;">1.991333</td>
<td headers="plc_nlc_ratio" class="gt_row gt_right">0.03409417</td>
</tr>
<tr>
<td headers="emsid" class="gt_row gt_left">E207466</td>
<td headers="name" class="gt_row gt_left">QUAMICHAN LAKE; CENTRE</td>
<td headers="lon" class="gt_row gt_right">-123.6625</td>
<td headers="lat" class="gt_row gt_right">48.8003</td>
<td headers="elev_m" class="gt_row gt_right">25</td>
<td headers="date" class="gt_row gt_right">2023-08-01</td>
<td headers="DOC" class="gt_row gt_right">6.61</td>
<td headers="Pabs" class="gt_row gt_right">176.645892</td>
<td headers="plc50" class="gt_row gt_right" style="background-color: #E7F6E3; color: #000000;">3.117431</td>
<td headers="plc_nlc_ratio" class="gt_row gt_right">0.05337440</td>
</tr>
</tbody>
</table>
</div>
<p>We can then modify the data to set a constant [DOC] (DOC = 5), and
calculate <span class="math inline">\(P_{abs}\)</span>, PLC50, and ratio
of PLC50:NLC50 for Anthracene using constant DOC = 5:</p>
<details>
&lt;summary style=’font-size:0.8em; margin-bottom:0; color: #666;&gt;
Show/Hide Code

<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">same_DOC</span> <span class="op">&lt;-</span> <span class="va">sites</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>DOC <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">multi_tuv</span><span class="op">(</span>pah <span class="op">=</span> <span class="st">"Anthracene"</span>, varying <span class="op">=</span> <span class="st">"DOC"</span><span class="op">)</span></span></code></pre></div>
</details><div id="amwpprvouq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#amwpprvouq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#amwpprvouq thead, #amwpprvouq tbody, #amwpprvouq tfoot, #amwpprvouq tr, #amwpprvouq td, #amwpprvouq th {
  border-style: none;
}

#amwpprvouq p {
  margin: 0;
  padding: 0;
}

#amwpprvouq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#amwpprvouq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#amwpprvouq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#amwpprvouq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#amwpprvouq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#amwpprvouq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#amwpprvouq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#amwpprvouq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#amwpprvouq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#amwpprvouq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#amwpprvouq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#amwpprvouq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#amwpprvouq .gt_spanner_row {
  border-bottom-style: hidden;
}

#amwpprvouq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#amwpprvouq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#amwpprvouq .gt_from_md > :first-child {
  margin-top: 0;
}

#amwpprvouq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#amwpprvouq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#amwpprvouq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#amwpprvouq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#amwpprvouq .gt_row_group_first td {
  border-top-width: 2px;
}

#amwpprvouq .gt_row_group_first th {
  border-top-width: 2px;
}

#amwpprvouq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#amwpprvouq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#amwpprvouq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#amwpprvouq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#amwpprvouq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#amwpprvouq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#amwpprvouq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#amwpprvouq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#amwpprvouq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#amwpprvouq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#amwpprvouq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#amwpprvouq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#amwpprvouq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#amwpprvouq .gt_left {
  text-align: left;
}

#amwpprvouq .gt_center {
  text-align: center;
}

#amwpprvouq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#amwpprvouq .gt_font_normal {
  font-weight: normal;
}

#amwpprvouq .gt_font_bold {
  font-weight: bold;
}

#amwpprvouq .gt_font_italic {
  font-style: italic;
}

#amwpprvouq .gt_super {
  font-size: 65%;
}

#amwpprvouq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#amwpprvouq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#amwpprvouq .gt_indent_1 {
  text-indent: 5px;
}

#amwpprvouq .gt_indent_2 {
  text-indent: 10px;
}

#amwpprvouq .gt_indent_3 {
  text-indent: 15px;
}

#amwpprvouq .gt_indent_4 {
  text-indent: 20px;
}

#amwpprvouq .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="emsid">emsid</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="name">name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lon">lon</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lat">lat</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="elev_m">elev_m</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="date">date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="DOC">DOC</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Pabs">Pabs</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="plc50">plc50</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="plc_nlc_ratio">plc_nlc_ratio</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="emsid" class="gt_row gt_left">0400390</td>
<td headers="name" class="gt_row gt_left">CHARLIE L DEEP STATION 1.2 KM EAST OF PARK</td>
<td headers="lon" class="gt_row gt_right">-120.9642</td>
<td headers="lat" class="gt_row gt_right">56.3125</td>
<td headers="elev_m" class="gt_row gt_right">693</td>
<td headers="date" class="gt_row gt_right">2023-08-01</td>
<td headers="DOC" class="gt_row gt_right">5</td>
<td headers="Pabs" class="gt_row gt_right">349.4598</td>
<td headers="plc50" class="gt_row gt_right" style="background-color: #00441B; color: #FFFFFF;">2.362989</td>
<td headers="plc_nlc_ratio" class="gt_row gt_right">0.04045740</td>
</tr>
<tr>
<td headers="emsid" class="gt_row gt_left">0500236</td>
<td headers="name" class="gt_row gt_left">OKANAGAN L D/S KELOWNA STP (DEEP)</td>
<td headers="lon" class="gt_row gt_right">-119.5134</td>
<td headers="lat" class="gt_row gt_right">49.8614</td>
<td headers="elev_m" class="gt_row gt_right">342</td>
<td headers="date" class="gt_row gt_right">2023-08-01</td>
<td headers="DOC" class="gt_row gt_right">5</td>
<td headers="Pabs" class="gt_row gt_right">375.3538</td>
<td headers="plc50" class="gt_row gt_right" style="background-color: #F3FAF0; color: #000000;">2.294903</td>
<td headers="plc_nlc_ratio" class="gt_row gt_right">0.03929168</td>
</tr>
<tr>
<td headers="emsid" class="gt_row gt_left">E207466</td>
<td headers="name" class="gt_row gt_left">QUAMICHAN LAKE; CENTRE</td>
<td headers="lon" class="gt_row gt_right">-123.6625</td>
<td headers="lat" class="gt_row gt_right">48.8003</td>
<td headers="elev_m" class="gt_row gt_right">25</td>
<td headers="date" class="gt_row gt_right">2023-08-01</td>
<td headers="DOC" class="gt_row gt_right">5</td>
<td headers="Pabs" class="gt_row gt_right">376.1315</td>
<td headers="plc50" class="gt_row gt_right" style="background-color: #F7FCF5; color: #000000;">2.292960</td>
<td headers="plc_nlc_ratio" class="gt_row gt_right">0.03925842</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="light-attenuation-coefficicent-k_d">Light Attenuation Coefficicent (<span class="math inline">\(k_d\)</span>)<a class="anchor" aria-label="anchor" href="#light-attenuation-coefficicent-k_d"></a>
</h2>
<p>The TUV model calculates the light attenuation coefficient <span class="math inline">\(k_d(λ)\)</span> for each wavelength, based on a
reference <span class="math inline">\(k_d(λ_{ref})\)</span>, where <span class="math inline">\(\lambda_{ref}\)</span> is the reference
wavelength.</p>
<p><span class="math inline">\(k_d(λ_{ref})\)</span> at 305nm (<span class="math inline">\(k_{d,305}\)</span>) can be estimated from
Dissolved Organic Carbon concentration [DOC] using the equation:</p>
<p><span class="math inline">\(k_{d,305} = a_{305}[DOC]^{b_{305}} +
0.13\)</span>; <span class="math inline">\(a_{305}\)</span> = 2.76 and
<span class="math inline">\(b_{305}\)</span> = 1.23 (Morris et al 1995;
Equation 4-1a in ARIS 2023)</p>
<p>For the sensitivity analysis for <span class="math inline">\(k_d\)</span>, it is more interpretable to supply a
range of <span class="math inline">\(k_d\)</span> values to the TUV
model directly, even though in practice it is more likely to use [DOC]
to estimate <span class="math inline">\(k_d\)</span>.</p>
<p>Using sample <span class="math inline">\(k_d\)</span> values from
Table 3 (ARIS 2023), from 0.08 to 275:</p>
<details><summary style="font-size:0.8em; margin-bottom:0; color: #666;&gt;
          Show/Hide Code
          &lt;/summary&gt;

```r
kd_vals &lt;- seq(0.08, 275, length.out = 20)
```

&lt;/details&gt;

### Effect of varying $k_d$ on PLC50 and ratio of PLC50:NLC50 for Anthracene

&lt;details&gt;
          &lt;summary style=" font-size:0.8em margin-bottom:0 color:>
          Show/Hide Code
          </summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kd_test_a</span> <span class="op">&lt;-</span> <span class="fu">multi_tuv</span><span class="op">(</span><span class="va">sites</span>, </span>
<span>                      pah <span class="op">=</span> <span class="st">"Anthracene"</span>, </span>
<span>                      varying <span class="op">=</span> <span class="st">"Kd_ref"</span>, </span>
<span>                      vals <span class="op">=</span> <span class="va">kd_vals</span>, </span>
<span>                      Kd_wvl <span class="op">=</span> <span class="fl">305</span>,</span>
<span>                      o3_tc <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                      tauaer <span class="op">=</span> <span class="fl">0.235</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">kd_test_a</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Kd_ref</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">TeX</span><span class="op">(</span><span class="st">r"(PLC50 for Anthracene at 3 sites in B.C. for a range of $k_d(305)$)"</span><span class="op">)</span>, </span>
<span>    x <span class="op">=</span> <span class="fu">TeX</span><span class="op">(</span><span class="st">r"($k_d(305)$)"</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"PLC50 (μg/L)"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</details><img src="sensitivity_files/figure-html/unnamed-chunk-16-1.png" width="768"><details><summary style='font-size:0.8em; margin-bottom:0; color: #666;&gt;
          Show/Hide Code
          &lt;/summary&gt;

```r

ggplot(kd_test_a, aes(x = Kd_ref, y = plc_nlc_ratio)) +
  geom_point() + 
  facet_wrap(vars(name), ncol = 1) +
  theme_bw() + 
  labs(
    title = TeX(r"(Ratio of PLC50:NLC50 for Anthracene at 3 sites in B.C. for a range of $k_d(305)$)"), 
    x = TeX(r"($k_d(305)$)"),
    y = "Ratio of PLC50:NLC50"
    )
```

&lt;/details&gt;&lt;img src="sensitivity_files/figure-html/unnamed-chunk-16-2.png" width="768" /&gt;

For Anthracene, the ratio of PLC50:NLC50 approaches 1 when $k_d(305)$ is ~ 
250 --- in other words at that level of $k_d$, PLC50 is nearly the same as NLC50, 
indicating that the light is attenuated to such an extent that the phototoxicity 
of Anthracene is not activated at the light levels when $k_d(305)$ &gt;= 250.

According to the above equation for estimating $k_d$ from [DOC]: 

$250 = 2.76[DOC]^{1.23} + 0.13$
[DOC] ~= 40

Therefore $k_d(305)$ of ~250 is representative of light attenuation when [DOC] 
is ~40. This is a significantly higher DOC concentration than observed in our 
three sample lakes, and is outside the range for which the above equation is 
recommended (it is recommended for [DOC] between 0.2 and 23 mg/L).

### Effect of varying $k_d$  on PLC50 and ratio of PLC50:NLC50 for Benzo[a]pyrene

&lt;details&gt;
          &lt;summary style=' font-size:0.8em margin-bottom:0 color:>
          Show/Hide Code
          </summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kd_test_b</span> <span class="op">&lt;-</span> <span class="fu">multi_tuv</span><span class="op">(</span><span class="va">sites</span>, </span>
<span>                      pah <span class="op">=</span> <span class="st">"Benzo[a]pyrene"</span>, </span>
<span>                      varying <span class="op">=</span> <span class="st">"Kd_ref"</span>, </span>
<span>                      vals <span class="op">=</span> <span class="va">kd_vals</span>,</span>
<span>                      o3_tc <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                      tauaer <span class="op">=</span> <span class="fl">0.235</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">kd_test_b</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Kd_ref</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"PLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of $k_d(305)$"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"$k_d(305)$"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"PLC50 (μg/L)"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</details><img src="sensitivity_files/figure-html/unnamed-chunk-17-1.png" width="768"><details><summary style='font-size:0.8em; margin-bottom:0; color: #666;&gt;
          Show/Hide Code
          &lt;/summary&gt;

```r

ggplot(kd_test_b, aes(x = Kd_ref, y = plc_nlc_ratio)) +
  geom_point() + 
  facet_wrap(vars(name), ncol = 1) +
  theme_bw() + 
  labs(
    title = "Ratio of PLC50:NLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of $k_d(305)$", 
    x = "$k_d(305)$",
    y = "Ratio of PLC50:NLC50"
    )
```

&lt;/details&gt;&lt;img src="sensitivity_files/figure-html/unnamed-chunk-17-2.png" width="768" /&gt;

## Surface Albedo (`albedo`)

We test surface albedo values from 0.05 to 0.1 (typical for water), and include 
the suggested default of 0.7:


```r
albedo_vals &lt;- c(seq(0.05, 0.1, length.out = 10), 0.07)
```

We will set DOC = 5 for all sites, and test the range of surface albedo values
at all three sites for Anthracene and Benzo[a]pyrene.

### Effect of varying Surface Albedo on PLC50 and ratio of PLC50:NLC50 for Anthracene

&lt;details&gt;
          &lt;summary style=' font-size:0.8em margin-bottom:0 color:>
          Show/Hide Code
          </summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">albedo_test_a</span> <span class="op">&lt;-</span> <span class="fu">multi_tuv</span><span class="op">(</span><span class="va">sites</span>, </span>
<span>                      pah <span class="op">=</span> <span class="st">"Anthracene"</span>, </span>
<span>                      varying <span class="op">=</span> <span class="st">"albedo"</span>, </span>
<span>                      vals <span class="op">=</span> <span class="va">albedo_vals</span>,</span>
<span>                      DOC <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                      o3_tc <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                      tauaer <span class="op">=</span> <span class="fl">0.235</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">albedo_test_a</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">albedo</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">albedo_test_a</span>, <span class="va">albedo</span> <span class="op">==</span> <span class="fl">0.07</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">albedo</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">albedo_test_a</span>, <span class="va">albedo</span> <span class="op">==</span> <span class="fl">0.07</span>, <span class="va">name</span> <span class="op">==</span> <span class="st">"QUAMICHAN LAKE; CENTRE"</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">albedo</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    label <span class="op">=</span> <span class="st">"Recommended default = 0.07"</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>    nudge_y <span class="op">=</span> <span class="fl">0.25</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"PLC50 for Anthracene at 3 sites in B.C. for a range of Surface Albedo"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"Surface Albedo"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"PLC50 (μg/L)"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</details><img src="sensitivity_files/figure-html/unnamed-chunk-19-1.png" width="768"><details><summary style='font-size:0.8em; margin-bottom:0; color: #666;&gt;
          Show/Hide Code
          &lt;/summary&gt;

```r

ggplot(albedo_test_a, aes(x = albedo, y = plc_nlc_ratio)) +
  geom_point() + 
  facet_wrap(vars(name), ncol = 1) +
    geom_point(
    data = filter(albedo_test_a, albedo == 0.07), 
    aes(x = albedo, y = plc_nlc_ratio),
    colour = "red"
  ) + 
  geom_text_repel(
    data = filter(albedo_test_a, albedo == 0.07, name == "QUAMICHAN LAKE; CENTRE"), 
    aes(x = albedo, y = plc_nlc_ratio),
    colour = "red", 
    label = "Recommended default = 0.07",
    nudge_x = 0.001,
    nudge_y = 0.0005
  ) +
  theme_bw() + 
  labs(
    title = "Ratio of PLC50:NLC50 for Anthracene at 3 sites in B.C. for a range of Surface Albedo", 
    x = "Surface Albedo",
    y = "Ratio of PLC50:NLC50"
    )
```

&lt;/details&gt;&lt;img src="sensitivity_files/figure-html/unnamed-chunk-19-2.png" width="768" /&gt;

### Effect of varying Surface Albedo on PLC50 and ratio of PLC50:NLC50 for Benzo[a]pyrene

&lt;details&gt;
          &lt;summary style=' font-size:0.8em margin-bottom:0 color:>
          Show/Hide Code
          </summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">albedo_test_b</span> <span class="op">&lt;-</span> <span class="fu">multi_tuv</span><span class="op">(</span><span class="va">sites</span>, </span>
<span>                      pah <span class="op">=</span> <span class="st">"Benzo[a]pyrene"</span>, </span>
<span>                      varying <span class="op">=</span> <span class="st">"albedo"</span>, </span>
<span>                      vals <span class="op">=</span> <span class="va">albedo_vals</span>,</span>
<span>                      DOC <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                      o3_tc <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                      tauaer <span class="op">=</span> <span class="fl">0.235</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">albedo_test_b</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">albedo</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">albedo_test_b</span>, <span class="va">albedo</span> <span class="op">==</span> <span class="fl">0.07</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">albedo</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">albedo_test_b</span>, <span class="va">albedo</span> <span class="op">==</span> <span class="fl">0.07</span>, <span class="va">name</span> <span class="op">==</span> <span class="st">"QUAMICHAN LAKE; CENTRE"</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">albedo</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    label <span class="op">=</span> <span class="st">"Recommended default = 0.07"</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>    nudge_y <span class="op">=</span> <span class="fl">0.1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"PLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Surface Albedo"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"Surface Albedo"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"PLC50 (μg/L)"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</details><img src="sensitivity_files/figure-html/unnamed-chunk-20-1.png" width="768"><details>
&lt;summary style=’font-size:0.8em; margin-bottom:0; color: #666;&gt;
Show/Hide Code

<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">albedo_test_b</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">albedo</span>, y <span class="op">=</span> <span class="va">plc_nlc_ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">albedo_test_b</span>, <span class="va">albedo</span> <span class="op">==</span> <span class="fl">0.07</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">albedo</span>, y <span class="op">=</span> <span class="va">plc_nlc_ratio</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">albedo_test_b</span>, <span class="va">albedo</span> <span class="op">==</span> <span class="fl">0.07</span>, <span class="va">name</span> <span class="op">==</span> <span class="st">"QUAMICHAN LAKE; CENTRE"</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">albedo</span>, y <span class="op">=</span> <span class="va">plc_nlc_ratio</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    label <span class="op">=</span> <span class="st">"Recommended default = 0.07"</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>    nudge_y <span class="op">=</span> <span class="fl">0.0003</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Ratio of PLC50:NLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Surface Albedo"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"Surface Albedo"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Ratio of PLC50:NLC50"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</details><p><img src="sensitivity_files/figure-html/unnamed-chunk-20-2.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="ozone-column-o3_tc">Ozone Column (<code>o3_tc</code>)<a class="anchor" aria-label="anchor" href="#ozone-column-o3_tc"></a>
</h2>
<p>The pahwq package currently uses average monthly ozone column data
from 1980-1991, which is bundled with the TUV model from Fortuin and H.
Kelder, 1998. Based on latitude and longitude and month, the ozone
column value is looked up and supplied to the TUV model. This default
behaviour can be overridden by supplying a value to the
<code>o3_tc</code> argument in the <code>set_tuv_aq_params</code>
function. In the absence of climatological data, the recommended default
value is 300 DU (ARIS 2023).</p>
<p>To test the sensitivity of PLC50 to ozone column, a range of values
is tested from 280-420 DU, which are typical values in middle to
Northern latitudes. See <a href="https://ozonewatch.gsfc.nasa.gov/facts/dobson_SH.html" class="external-link">NASA’s
‘Ozone Watch’ page</a> for more information on atmospheric ozone.</p>
<details><summary style="font-size:0.8em; margin-bottom:0; color: #666;&gt;
          Show/Hide Code
          &lt;/summary&gt;

```r
ozone_vals &lt;- seq(280, 420, by = 10)
```

&lt;/details&gt;

### Effect of varying Ozone Total Column on PLC50 and ratio of PLC50:NLC50 for Anthracene

&lt;details&gt;
          &lt;summary style=" font-size:0.8em margin-bottom:0 color:>
          Show/Hide Code
          </summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ozone_test_a</span> <span class="op">&lt;-</span> <span class="fu">multi_tuv</span><span class="op">(</span><span class="va">sites</span>, </span>
<span>                      pah <span class="op">=</span> <span class="st">"Anthracene"</span>, </span>
<span>                      varying <span class="op">=</span> <span class="st">"o3_tc"</span>, </span>
<span>                      vals <span class="op">=</span> <span class="va">ozone_vals</span>,</span>
<span>                      DOC <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                      tauaer <span class="op">=</span> <span class="fl">0.235</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ozone_test_a</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">o3_tc</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ozone_test_a</span>, <span class="va">o3_tc</span> <span class="op">==</span> <span class="fl">300</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">o3_tc</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ozone_test_a</span>, <span class="va">o3_tc</span> <span class="op">==</span> <span class="fl">300</span>, <span class="va">name</span> <span class="op">==</span> <span class="st">"QUAMICHAN LAKE; CENTRE"</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">o3_tc</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    label <span class="op">=</span> <span class="st">"Recommended default = 300"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"PLC50 for Anthracene at 3 sites in B.C. for a range of Ozone Total Column"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"Ozone Total Column"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"PLC50 (μg/L)"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</details><img src="sensitivity_files/figure-html/unnamed-chunk-22-1.png" width="768"><details><summary style='font-size:0.8em; margin-bottom:0; color: #666;&gt;
          Show/Hide Code
          &lt;/summary&gt;

```r

ggplot(ozone_test_a, aes(x = o3_tc, y = plc_nlc_ratio)) +
  geom_point() + 
  facet_wrap(vars(name), ncol = 1) +
    geom_point(
    data = filter(ozone_test_a, o3_tc == 300), 
    aes(x = o3_tc, y = plc_nlc_ratio),
    colour = "red"
  ) + 
  geom_text_repel(
    data = filter(ozone_test_a, o3_tc == 300, name == "QUAMICHAN LAKE; CENTRE"), 
    aes(x = o3_tc, y = plc_nlc_ratio),
    colour = "red", 
    label = "Recommended default = 300"
  ) +
  theme_bw() + 
  labs(
    title = "Ratio of PLC50:NLC50 for Anthracene at 3 sites in B.C. for a range of Ozone Total Column", 
    x = "Ozone Total Column",
    y = "Ratio of PLC50:NLC50"
    )
```

&lt;/details&gt;&lt;img src="sensitivity_files/figure-html/unnamed-chunk-22-2.png" width="768" /&gt;

### Effect of varying Ozone Total Column on PLC50 and ratio of PLC50:NLC50 for Benzo[a]pyrene

&lt;details&gt;
          &lt;summary style=' font-size:0.8em margin-bottom:0 color:>
          Show/Hide Code
          </summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ozone_test_b</span> <span class="op">&lt;-</span> <span class="fu">multi_tuv</span><span class="op">(</span><span class="va">sites</span>, </span>
<span>                      pah <span class="op">=</span> <span class="st">"Benzo[a]pyrene"</span>, </span>
<span>                      varying <span class="op">=</span> <span class="st">"o3_tc"</span>, </span>
<span>                      vals <span class="op">=</span> <span class="va">ozone_vals</span>,</span>
<span>                      DOC <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                      tauaer <span class="op">=</span> <span class="fl">0.235</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ozone_test_b</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">o3_tc</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ozone_test_b</span>, <span class="va">o3_tc</span> <span class="op">==</span> <span class="fl">300</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">o3_tc</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ozone_test_b</span>, <span class="va">o3_tc</span> <span class="op">==</span> <span class="fl">300</span>, <span class="va">name</span> <span class="op">==</span> <span class="st">"QUAMICHAN LAKE; CENTRE"</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">o3_tc</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    label <span class="op">=</span> <span class="st">"Recommended default = 300"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"PLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Ozone Total Column"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"Ozone Total Column"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"PLC50 (μg/L)"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</details><img src="sensitivity_files/figure-html/unnamed-chunk-23-1.png" width="768"><details><summary style='font-size:0.8em; margin-bottom:0; color: #666;&gt;
          Show/Hide Code
          &lt;/summary&gt;

```r

ggplot(ozone_test_b, aes(x = o3_tc, y = plc_nlc_ratio)) +
  geom_point() + 
  facet_wrap(vars(name), ncol = 1) +
    geom_point(
    data = filter(ozone_test_b, o3_tc == 300), 
    aes(x = o3_tc, y = plc_nlc_ratio),
    colour = "red"
  ) + 
  geom_text_repel(
    data = filter(ozone_test_b, o3_tc == 300, name == "QUAMICHAN LAKE; CENTRE"), 
    aes(x = o3_tc, y = plc_nlc_ratio),
    colour = "red", 
    label = "Recommended default = 300"
  ) +
  theme_bw() + 
  labs(
    title = "Ratio of PLC50:NLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Ozone Total Column", 
    x = "Ozone Total Column",
    y = "Ratio of PLC50:NLC50"
    )
```

&lt;/details&gt;&lt;img src="sensitivity_files/figure-html/unnamed-chunk-23-2.png" width="768" /&gt;

## Aerosol Optical Depth (`tauaer`)

The pahwq package currently uses average monthly aerosol optical depth data from 
2002 to 2023, obtained from MODIS/Aqua satellite data. Based on latitude and 
longitude and month, the AOD value is looked up and supplied to the TUV model. 
This default behaviour can be overridden by supplying a value to the `tauaer` 
argument in the `set_tuv_aq_params` function. In the absence of
climatological data, the recommended default value is 0.235 (ARIS 2023).

To test the sensitivity of PLC50 to AOD, a range of values is tested from 0.1 
(clear skies with maximum visibility) to 1.0 (very hazy skies). See the 
[NASA Earth Observatory page on aerosols](https://earthobservatory.nasa.gov/global-maps/MODAL2_M_AER_OD).

&lt;details&gt;
          &lt;summary style=' font-size:0.8em margin-bottom:0 color:>
          Show/Hide Code
          </summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aod_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1.0</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="fl">0.235</span><span class="op">)</span></span></code></pre></div>
</details><div class="section level3">
<h3 id="effect-of-varying-aerosol-optical-depth-aod-on-plc50-and-ratio-of-plc50nlc50-for-anthracene">Effect of Varying Aerosol Optical Depth (AOD) on PLC50 and ratio of
PLC50:NLC50 for Anthracene<a class="anchor" aria-label="anchor" href="#effect-of-varying-aerosol-optical-depth-aod-on-plc50-and-ratio-of-plc50nlc50-for-anthracene"></a>
</h3>
<details><summary style='font-size:0.8em; margin-bottom:0; color: #666;&gt;
          Show/Hide Code
          &lt;/summary&gt;

```r
aod_test_a &lt;- multi_tuv(sites, 
                      pah = "Anthracene", 
                      varying = "tauaer", 
                      vals = aod_vals,
                      DOC = 5,
                      o3_tc = 300)

ggplot(aod_test_a, aes(x = tauaer, y = plc50)) +
  geom_point() + 
  facet_wrap(vars(name), ncol = 1) +
  geom_point(
    data = filter(aod_test_a, tauaer == 0.235), 
    aes(x = tauaer, y = plc50),
    colour = "red"
  ) + 
  geom_text_repel(
    data = filter(aod_test_a, tauaer == 0.235, name == "QUAMICHAN LAKE; CENTRE"), 
    aes(x = tauaer, y = plc50),
    colour = "red", 
    label = "Recommended default = 0.235",
    nudge_y = 0.1
  ) +
  theme_bw() + 
  labs(
    title = "PLC50 for Anthracene at 3 sites in B.C. for a range of Aeorosol Optical Depth", 
    x = "Aeorosol Optical Depth",
    y = "PLC50 (μg/L)"
  )
```

&lt;/details&gt;&lt;img src="sensitivity_files/figure-html/unnamed-chunk-25-1.png" width="768" /&gt;&lt;details&gt;
          &lt;summary style=' font-size:0.8em margin-bottom:0 color:>
          Show/Hide Code
          </summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">aod_test_a</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">tauaer</span>, y <span class="op">=</span> <span class="va">plc_nlc_ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">aod_test_a</span>, <span class="va">tauaer</span> <span class="op">==</span> <span class="fl">0.235</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">tauaer</span>, y <span class="op">=</span> <span class="va">plc_nlc_ratio</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">aod_test_a</span>, <span class="va">tauaer</span> <span class="op">==</span> <span class="fl">0.235</span>, <span class="va">name</span> <span class="op">==</span> <span class="st">"QUAMICHAN LAKE; CENTRE"</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">tauaer</span>, y <span class="op">=</span> <span class="va">plc_nlc_ratio</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    label <span class="op">=</span> <span class="st">"Recommended default = 0.235"</span>,</span>
<span>    nudge_y <span class="op">=</span> <span class="fl">0.002</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Ratio of PLC50:NLC50 for Anthracene at 3 sites in B.C. for a range of Aeorosol Optical Depth"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"Aeorosol Optical Depth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Ratio of PLC50:NLC50"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</details><p><img src="sensitivity_files/figure-html/unnamed-chunk-25-2.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="effect-of-varying-aerosol-optical-depth-aod-on-plc50-and-ratio-of-plc50nlc50-for-benzoapyrene">Effect of varying Aerosol Optical Depth (AOD) on PLC50 and ratio of
PLC50:NLC50 for Benzo[a]pyrene<a class="anchor" aria-label="anchor" href="#effect-of-varying-aerosol-optical-depth-aod-on-plc50-and-ratio-of-plc50nlc50-for-benzoapyrene"></a>
</h3>
<details><summary style='font-size:0.8em; margin-bottom:0; color: #666;&gt;
          Show/Hide Code
          &lt;/summary&gt;

```r
aod_test_b &lt;- multi_tuv(sites, 
                      pah = "Benzo[a]pyrene", 
                      varying = "tauaer", 
                      vals = aod_vals,
                      DOC = 5,
                      o3_tc = 300)

ggplot(aod_test_b, aes(x = tauaer, y = plc50)) +
  geom_point() + 
  facet_wrap(vars(name), ncol = 1) +
  geom_point(
    data = filter(aod_test_b, tauaer == 0.235), 
    aes(x = tauaer, y = plc50),
    colour = "red"
  ) + 
  geom_text_repel(
    data = filter(aod_test_b, tauaer == 0.235, name == "QUAMICHAN LAKE; CENTRE"), 
    aes(x = tauaer, y = plc50),
    colour = "red", 
    label = "Recommended default = 0.235",
    nudge_y = 0.002
  ) +
  theme_bw() + 
  labs(
    title = "PLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Aeorosol Optical Depth", 
    x = "Aeorosol Optical Depth",
    y = "PLC50 (μg/L)"
  )
```

&lt;/details&gt;&lt;img src="sensitivity_files/figure-html/unnamed-chunk-26-1.png" width="768" /&gt;&lt;details&gt;
          &lt;summary style=' font-size:0.8em margin-bottom:0 color:>
          Show/Hide Code
          </summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">aod_test_b</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">tauaer</span>, y <span class="op">=</span> <span class="va">plc_nlc_ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">aod_test_b</span>, <span class="va">tauaer</span> <span class="op">==</span> <span class="fl">0.235</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">tauaer</span>, y <span class="op">=</span> <span class="va">plc_nlc_ratio</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">aod_test_b</span>, <span class="va">tauaer</span> <span class="op">==</span> <span class="fl">0.235</span>, <span class="va">name</span> <span class="op">==</span> <span class="st">"QUAMICHAN LAKE; CENTRE"</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">tauaer</span>, y <span class="op">=</span> <span class="va">plc_nlc_ratio</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    label <span class="op">=</span> <span class="st">"Recommended default = 0.235"</span>,</span>
<span>    nudge_y <span class="op">=</span> <span class="fl">0.001</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Ratio of PLC50:NLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Aeorosol Optical Depth"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"Aeorosol Optical Depth"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Ratio of PLC50:NLC50"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</details><p><img src="sensitivity_files/figure-html/unnamed-chunk-26-2.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="aerosol-single-scattering-albedo-ssaaer">Aerosol Single Scattering Albedo (<code>ssaaer</code>)<a class="anchor" aria-label="anchor" href="#aerosol-single-scattering-albedo-ssaaer"></a>
</h2>
<p>Aerosol Single Scattering Albedo is currently set as a default
constant value of 0.99. This can be overridden by setting the
<code>ssaaer</code> parameter of the <code><a href="../reference/set_tuv_aq_params.html">set_tuv_aq_params()</a></code>
function to a different value.</p>
<p>Here we test a range for values from 0.80 to 0.99, including the
recommended default of 0.99 (ARIS 2023).</p>
<details><summary style="font-size:0.8em; margin-bottom:0; color: #666;&gt;
          Show/Hide Code
          &lt;/summary&gt;

```r
ssa_vals &lt;- seq(0.8, 0.99, length.out = 10)
```

&lt;/details&gt;

### Effect of varying Aerosol Single Scattering Albedo on PLC50 and ratio of PLC50:NLC50 for Anthracene

&lt;details&gt;
          &lt;summary style=" font-size:0.8em margin-bottom:0 color:>
          Show/Hide Code
          </summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssa_test_a</span> <span class="op">&lt;-</span> <span class="fu">multi_tuv</span><span class="op">(</span><span class="va">sites</span>, </span>
<span>                      pah <span class="op">=</span> <span class="st">"Anthracene"</span>, </span>
<span>                      varying <span class="op">=</span> <span class="st">"ssaaer"</span>, </span>
<span>                      vals <span class="op">=</span> <span class="va">ssa_vals</span>,</span>
<span>                      DOC <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                      o3_tc <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                      tauaer <span class="op">=</span> <span class="fl">0.235</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ssa_test_a</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ssaaer</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ssa_test_a</span>, <span class="va">ssaaer</span> <span class="op">==</span> <span class="fl">0.99</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ssaaer</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ssa_test_a</span>, <span class="va">ssaaer</span> <span class="op">==</span> <span class="fl">0.99</span>, <span class="va">name</span> <span class="op">==</span> <span class="st">"QUAMICHAN LAKE; CENTRE"</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ssaaer</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    label <span class="op">=</span> <span class="st">"Recommended default = 0.99"</span>,</span>
<span>    nudge_y <span class="op">=</span> <span class="fl">.06</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"PLC50 for Anthracene at 3 sites in B.C. for a range of Aeorosol Single Scattering Albedo"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"Aeorosol Single Scattering Albedo"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"PLC50 (μg/L)"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</details><img src="sensitivity_files/figure-html/unnamed-chunk-28-1.png" width="768"><details><summary style='font-size:0.8em; margin-bottom:0; color: #666;&gt;
          Show/Hide Code
          &lt;/summary&gt;

```r

ggplot(ssa_test_a, aes(x = ssaaer, y = plc_nlc_ratio)) +
  geom_point() + 
  facet_wrap(vars(name), ncol = 1) +
    geom_point(
    data = filter(ssa_test_a, ssaaer == 0.99), 
    aes(x = ssaaer, y = plc_nlc_ratio),
    colour = "red"
  ) + 
  geom_text_repel(
    data = filter(ssa_test_a, ssaaer == 0.99, name == "QUAMICHAN LAKE; CENTRE"), 
    aes(x = ssaaer, y = plc_nlc_ratio),
    colour = "red", 
    label = "Recommended default = 0.99",
    nudge_y = .001
  ) +
  theme_bw() + 
  labs(
    title = "Ratio of PLC50:NLC50 for Anthracene at 3 sites in B.C. for a range of Aeorosol Single Scattering Albedo", 
    x = "Aeorosol Single Scattering Albedo",
    y = "Ratio of PLC50:NLC50"
    )
```

&lt;/details&gt;&lt;img src="sensitivity_files/figure-html/unnamed-chunk-28-2.png" width="768" /&gt;

### Effect of varying Aerosol Single Scattering Albedo on PLC50 and ratio of PLC50:NLC50 for Benzo[a]pyrene

&lt;details&gt;
          &lt;summary style=' font-size:0.8em margin-bottom:0 color:>
          Show/Hide Code
          </summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssa_test_b</span> <span class="op">&lt;-</span> <span class="fu">multi_tuv</span><span class="op">(</span><span class="va">sites</span>, </span>
<span>                      pah <span class="op">=</span> <span class="st">"Benzo[a]pyrene"</span>, </span>
<span>                      varying <span class="op">=</span> <span class="st">"ssaaer"</span>, </span>
<span>                      vals <span class="op">=</span> <span class="va">ssa_vals</span>,</span>
<span>                      DOC <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                      o3_tc <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                      tauaer <span class="op">=</span> <span class="fl">0.235</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ssa_test_b</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ssaaer</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ssa_test_b</span>, <span class="va">ssaaer</span> <span class="op">==</span> <span class="fl">0.99</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ssaaer</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ssa_test_b</span>, <span class="va">ssaaer</span> <span class="op">==</span> <span class="fl">0.99</span>, <span class="va">name</span> <span class="op">==</span> <span class="st">"QUAMICHAN LAKE; CENTRE"</span><span class="op">)</span>, </span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ssaaer</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    label <span class="op">=</span> <span class="st">"Recommended default = 0.99"</span>,</span>
<span>    nudge_y <span class="op">=</span> <span class="fl">.001</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"PLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Aeorosol Single Scattering Albedo"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"Aeorosol Single Scattering Albedo"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"PLC50 (μg/L)"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</details><img src="sensitivity_files/figure-html/unnamed-chunk-29-1.png" width="768"><details><summary style='font-size:0.8em; margin-bottom:0; color: #666;&gt;
          Show/Hide Code
          &lt;/summary&gt;

```r

ggplot(ssa_test_b, aes(x = ssaaer, y = plc_nlc_ratio)) +
  geom_point() + 
  facet_wrap(vars(name), ncol = 1) +
      geom_point(
    data = filter(ssa_test_b, ssaaer == 0.99), 
    aes(x = ssaaer, y = plc_nlc_ratio),
    colour = "red"
  ) + 
  geom_text_repel(
    data = filter(ssa_test_b, ssaaer == 0.99, name == "QUAMICHAN LAKE; CENTRE"), 
    aes(x = ssaaer, y = plc_nlc_ratio),
    colour = "red", 
    label = "Recommended default = 0.99",
    nudge_y = .0005
  ) +
  theme_bw() + 
  labs(
    title = "Ratio of PLC50:NLC50 for Benzo[a]pyrene at 3 sites in B.C. for a range of Aeorosol Single Scattering Albedo", 
    x = "Aeorosol Single Scattering Albedo",
    y = "Ratio of PLC50:NLC50"
    )
```

&lt;/details&gt;&lt;img src="sensitivity_files/figure-html/unnamed-chunk-29-2.png" width="768" /&gt;

## Latitude

Latitude has a strong effect on the angle of the sun, which will in turn affect
the light penetration through water, thus it is important to investigate the 
sensitivity of the calculation of PLC50 to variation in latitude.

For this analysis, we will maintain the longitudes associated with each site, 
and make "mock" sites by creating a range of latitudes from 48 to 72 degrees N 
and pair those with the longitudes of the original sites.


```r
lat_vals &lt;- seq(48, 72, by = 2)
```


&lt;details&gt;
          &lt;summary style=' font-size:0.8em margin-bottom:0 color:>
          Show/Hide Code
          </summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lat_test_a</span> <span class="op">&lt;-</span> <span class="fu">multi_tuv</span><span class="op">(</span><span class="va">sites</span>, </span>
<span>                      pah <span class="op">=</span> <span class="st">"Anthracene"</span>, </span>
<span>                      varying <span class="op">=</span> <span class="st">"lat"</span>, </span>
<span>                      vals <span class="op">=</span> <span class="va">lat_vals</span>,</span>
<span>                      DOC <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                      o3_tc <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                      tauaer <span class="op">=</span> <span class="fl">0.235</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">lat_test_a</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">lat</span>, y <span class="op">=</span> <span class="va">plc50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">lon</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, labeller <span class="op">=</span> <span class="fu">as_labeller</span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Longitude: "</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"PLC50 for Anthracene at 3 sites in B.C. for a range of latitudes"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"latitudes"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"PLC50 (μg/L)"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</details><img src="sensitivity_files/figure-html/unnamed-chunk-31-1.png" width="768"><details>
&lt;summary style=’font-size:0.8em; margin-bottom:0; color: #666;&gt;
Show/Hide Code

<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">lat_test_a</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">lat</span>, y <span class="op">=</span> <span class="va">plc_nlc_ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">lon</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, labeller <span class="op">=</span> <span class="fu">as_labeller</span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Longitude: "</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Ratio of PLC50:NLC50 for Anthracene at 3 sites in B.C. for a range of latitudes"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"latitudes"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Ratio of PLC50:NLC50"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</details><p><img src="sensitivity_files/figure-html/unnamed-chunk-31-2.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="lon">
<code>lon</code><a class="anchor" aria-label="anchor" href="#lon"></a>
</h2>
</div>
<div class="section level2">
<h2 id="elev_km">
<code>elev_km</code><a class="anchor" aria-label="anchor" href="#elev_km"></a>
</h2>
</div>
<div class="section level2">
<h2 id="nstr">
<code>nstr</code><a class="anchor" aria-label="anchor" href="#nstr"></a>
</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">multi_tuv</span><span class="op">(</span><span class="va">sites</span>, </span>
<span>          pah <span class="op">=</span> <span class="st">"Anthracene"</span>, </span>
<span>          varying <span class="op">=</span> <span class="st">"nstr"</span>, </span>
<span>          vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, </span>
<span>          DOC <span class="op">=</span> <span class="fl">5</span>,</span>
<span>          o3_tc <span class="op">=</span> <span class="fl">300</span>,</span>
<span>          tauaer <span class="op">=</span> <span class="fl">0.235</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Andy Teucher.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
